import{_ as i,c as a,a as h,o as n}from"./app-BO2U5m27.js";const l={};function k(p,s){return n(),a("div",null,[...s[0]||(s[0]=[h(`<p>子查询指一个查询语句嵌套在另一个查询语句内部的查询，这个特性从MySQL 4.1 开始引入。</p><p>SQL 中子查询的使用大大增强了 SELECT 查询的能力，因为很多时候查询需要从结果集中获取数据，或者需要从同一个表中先计算得出一个数据结果，然后与这个数据结果（可能是某个标量，也可能是某个集合）进行比较。</p><h2 id="_1-需求分析与问题解决" tabindex="-1"><a class="header-anchor" href="#_1-需求分析与问题解决"><span>1. 需求分析与问题解决</span></a></h2><h3 id="_1-1-实际问题" tabindex="-1"><a class="header-anchor" href="#_1-1-实际问题"><span>1.1 实际问题</span></a></h3><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062300-b80df077-2fe3-4e2b-a7fa-90e866884e10.png" alt=""></p><p>现有解决方式:</p><p>方式一: 先查出工资，在用去查第二个条件</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">Abel</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 11000</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><p>方式二：自连接</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">last_name</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">       e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees e1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       employees e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">last_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">Abel</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">       AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">salary</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">salary</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><p>方式三：子查询</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">Abel</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><h3 id="_1-2-子查询的基本使用" tabindex="-1"><a class="header-anchor" href="#_1-2-子查询的基本使用"><span>1.2 子查询的基本使用</span></a></h3><ul><li>子查询的基本语法结构</li></ul><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062386-bb48a089-53d7-4ab5-944b-c1f77392fe1e.png" alt=""></p><ul><li>子查询（内查询）在主查询之前一次执行完成</li><li>子查询的结果被主查询（外查询）使用</li><li>注意事项 <ul><li>子查询要包含在括号内</li><li>将子查询放在比较条件的右侧</li><li>单行操作符对应单行子查询，多行操作符对应多行子查询</li></ul></li></ul><h3 id="_1-3-子查询的分类" tabindex="-1"><a class="header-anchor" href="#_1-3-子查询的分类"><span>1.3 子查询的分类</span></a></h3><p><strong>分类方式 1:</strong></p><p>我们按内查询的结果返回一条还是多条记录，将子查询分为<strong>单行子查询</strong>、<strong>多行子查询</strong>。</p><ul><li>单行子查询<br><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062455-309cfec4-c741-4f76-845d-8c461fe6240f.png" alt=""></li><li>多行子查询<br><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062544-dd49a58f-1a75-4e97-badc-9b1ea73a272e.png" alt=""></li></ul><p><strong>分类方式 2:</strong></p><p>我们按内查询是否被执行多次，将子查询划分为<strong>相关(或关联)子查询</strong>和<strong>不相关(或非关联)子查询</strong>。</p><p>子查询从数据表中查询了数据结果，如果这个数据结果只执行一次，然后这个数据结果作为主查询的条件进行执行，那么这样的子查询叫做<strong>不相关子查询。</strong></p><p>同样，如果子查询需要执行多次，即采用循环的方式，先从外部查询开始，每次都传入子查询进行查询，然后再将结果反馈给外部，这种嵌套的执行方式就称为<strong>相关子查询。</strong></p><h2 id="_2-单行子查询" tabindex="-1"><a class="header-anchor" href="#_2-单行子查询"><span>2. 单行子查询</span></a></h2><h3 id="_2-1-单行比较操作符" tabindex="-1"><a class="header-anchor" href="#_2-1-单行比较操作符"><span>2.1 单行比较操作符</span></a></h3><table><thead><tr><th>操作符</th><th>含义</th></tr></thead><tbody><tr><td>=</td><td>equal to</td></tr><tr><td>&gt;</td><td>greater than</td></tr><tr><td>&gt;=</td><td>greater than or equal to</td></tr><tr><td>&lt;</td><td>less than</td></tr><tr><td>&lt;=</td><td>less than or equal to</td></tr><tr><td>&lt;&gt;</td><td>not equal to</td></tr></tbody></table><h3 id="_2-2-代码示例" tabindex="-1"><a class="header-anchor" href="#_2-2-代码示例"><span>2.2 代码示例</span></a></h3><p><strong>题目：查询工资大于 149 号员工工资的员工的信息:</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062599-9320291d-b516-4ea1-9ee9-2704cba0dd91.png" alt=""></p><p><strong>题目：返回job_id与 141 号员工相同，salary比 143 号员工多的员工姓名，job_id和工资:</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       job_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  job_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> job_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 141</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">       AND</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                     FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                     WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 143</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><p><strong>题目：返回公司工资最少的员工的last_name,job_id和salary:</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       job_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Min</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees);</span></span></code></pre></div><p><strong>题目：查询与 141 号或 174 号员工的manager_id和department_id相同的其他员工的employee_id，manager_id，department_id:</strong></p><p>实现方式 1 ：不成对比较</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       manager_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  manager_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> manager_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                      FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                      WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">174</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">141</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">       AND</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                             FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                             WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">174</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">141</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">       AND</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">174</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">141</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span></code></pre></div><p>实现方式 2 ：成对比较</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       manager_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  ( manager_id, department_id ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> manager_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">                                                department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                                         FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                                         WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">141</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">174</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">       AND</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">141</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">174</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span></code></pre></div><h3 id="_2-3-having-中的子查询" tabindex="-1"><a class="header-anchor" href="#_2-3-having-中的子查询"><span>2.3 HAVING 中的子查询</span></a></h3><ul><li>首先执行子查询</li><li>向主查询中的HAVING 子句返回结果</li></ul><p><strong>题目：查询最低工资大于 50 号部门最低工资的部门id和其最低工资:</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">       Min</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">HAVING</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Min</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Min</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                      FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                      WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><h3 id="_2-4-case中的子查询" tabindex="-1"><a class="header-anchor" href="#_2-4-case中的子查询"><span>2.4 CASE中的子查询</span></a></h3><p>在CASE表达式中使用单列子查询:</p><p><strong>题目：显式员工的employee_id,last_name和location。其中，若员工department_id与location_id为 1800 的department_id相同，则location为’Canada’，其余则为’USA’:</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CASE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">           WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   departments</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  location_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1800</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">THEN</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">Canada</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">           ELSE</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">USA</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">         END</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">location</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees;</span></span></code></pre></div><h3 id="_2-5-子查询中的空值问题" tabindex="-1"><a class="header-anchor" href="#_2-5-子查询中的空值问题"><span>2.5 子查询中的空值问题</span></a></h3><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       job_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  job_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> job_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">Haas</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><blockquote><p>子查询不返回任何行</p></blockquote><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062649-8503905e-c6a0-47c5-920f-7aa65ac2e19d.png" alt=""></p><h3 id="_2-6-非法使用子查询" tabindex="-1"><a class="header-anchor" href="#_2-6-非法使用子查询"><span>2.6 非法使用子查询</span></a></h3><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       last_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Min</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id);</span></span></code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062704-187a1b29-d61a-4dea-b9d6-f757b6febd2e.png" alt=""></p><blockquote><p>多行子查询使用单行比较符</p></blockquote><h2 id="_3-多行子查询" tabindex="-1"><a class="header-anchor" href="#_3-多行子查询"><span>3. 多行子查询</span></a></h2><ul><li>也称为集合比较子查询</li><li>内查询返回多行</li><li>使用多行比较操作符</li></ul><h3 id="_3-1-多行比较操作符" tabindex="-1"><a class="header-anchor" href="#_3-1-多行比较操作符"><span>3.1 多行比较操作符</span></a></h3><table><thead><tr><th>操作符</th><th>含义</th></tr></thead><tbody><tr><td>IN</td><td>等于列表中的<strong>任意一个</strong></td></tr><tr><td>ANY</td><td>需要和单行比较操作符一起使用，和子查询返回的<strong>某一个</strong>值比较</td></tr><tr><td>ALL</td><td>需要和单行比较操作符一起使用，和子查询返回的<strong>所有</strong>值比较</td></tr><tr><td>SOME</td><td><strong>实际上是ANY的别名</strong>，作用相同，一般常使用ANY</td></tr></tbody></table><blockquote><p>体会 ANY 和 ALL 的区别</p></blockquote><h3 id="_3-2-代码示例" tabindex="-1"><a class="header-anchor" href="#_3-2-代码示例"><span>3.2 代码示例</span></a></h3><p><strong>题目：返回其它job_id中比job_id为‘IT_PROG’部门</strong><code>任一</code><strong>工资低的员工的员工号、姓名、job_id 以及salary</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062757-3be27e91-9fc7-46ae-b95a-bcf3d3a495eb.png" alt=""></p><p><strong>题目：返回其它job_id中比job_id为‘IT_PROG’部门</strong><code>所有</code><strong>工资都低的员工的员工号、姓名、job_id以及salary</strong></p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062833-c9c822c6-a993-41fa-9029-7ea6fc88c987.png" alt=""></p><p><strong>题目：查询平均工资最低的部门id:</strong></p><p>方式 1:</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">HAVING</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Avg</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Min</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(avg_sal)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                      FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Avg</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) avg_sal</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                              FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                              GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id) dept_avg_sal);</span></span></code></pre></div><p>方式 2:</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">HAVING</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Avg</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ALL (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Avg</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) avg_sal</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                           FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                           GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id);</span></span></code></pre></div><h3 id="_3-3-空值问题" tabindex="-1"><a class="header-anchor" href="#_3-3-空值问题"><span>3.3 空值问题</span></a></h3><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> last_name</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">   employees</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">  employee_id</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> NOT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (SELECT </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">manager_id</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt;                            </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">   employees</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Empty</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h2 id="_4-相关子查询" tabindex="-1"><a class="header-anchor" href="#_4-相关子查询"><span>4. 相关子查询</span></a></h2><h3 id="_4-1-相关子查询执行流程" tabindex="-1"><a class="header-anchor" href="#_4-1-相关子查询执行流程"><span>4.1 相关子查询执行流程</span></a></h3><p>如果子查询的执行依赖于外部查询，通常情况下都是因为子查询中的表用到了外部的表，并进行了条件关联，因此每执行一次外部查询，子查询都要重新计算一次，这样的子查询就称之为<strong>关联子查询</strong>。</p><p>相关子查询按照一行接一行的顺序执行，主查询的每一行都执行一次子查询。</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062909-b392c05c-1718-4108-a027-3ab2ad0576b9.png" alt=""></p><p>说明： <strong>子查询中使用主查询中的列</strong>。</p><h3 id="_4-2-代码示例" tabindex="-1"><a class="header-anchor" href="#_4-2-代码示例"><span>4.2 代码示例</span></a></h3><p><strong>题目：查询员工中工资大于本部门平均工资的员工的last_name,salary和其department_id:</strong></p><p>方式一：相关子查询<br><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062972-9d73384a-e4ab-4347-811e-0ac1a8cfa260.png" alt=""><br> 方式二：在 FROM 中使用子查询</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       salary,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">       e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees e1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">               Avg</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) dept_avg_sal</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">        FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">        GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id) e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">       AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">dept_avg_sal</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">salary</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><blockquote><p>from型的子查询：子查询是作为from的一部分，子查询要用<code>()</code>引起来，并且要给这个子查询取别名， 把它当成一张“临时的虚拟的表”来使用。</p></blockquote><p>在 ORDER BY 中使用子查询:</p><p><strong>题目：查询员工的id,salary,按照department_name 排序:</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees e</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">           FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   departments d</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">           WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  e</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><p><strong>题目：若employees表中employee_id与job_history表中employee_id相同的数目不小于 2 ，输出这些相同id的员工的employee_id,last_name和其job_id:</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">employee_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       last_name,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">       e</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">job_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees e</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> &lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Count</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">             FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   job_history</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">             WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">employee_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><h3 id="_4-3-exists-与-not-exists关键字" tabindex="-1"><a class="header-anchor" href="#_4-3-exists-与-not-exists关键字"><span>4.3 EXISTS 与 NOT EXISTS关键字</span></a></h3><ul><li>关联子查询通常也会和 EXISTS操作符一起来使用，用来检查在子查询中是否存在满足条件的行</li><li>如果在子查询中<strong>不存在</strong>满足条件的行: <ul><li>条件返回 <code>FALSE</code></li><li>继续在子查询中查找</li></ul></li><li>如果在子查询中<strong>存在</strong>满足条件的行: <ul><li>不在子查询中继续查找</li><li>条件返回 <code>TRUE</code></li></ul></li><li>NOT EXISTS关键字表示如果不存在某种条件，则返回TRUE，否则返回FALSE</li></ul><p><strong>题目：查询公司管理者的employee_id，last_name，job_id，department_id信息:</strong></p><p>方式一:</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       job_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees e1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> *</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">               FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">               WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">manager_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">employee_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><p>方式二：自连接</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT DISTINCT</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">employee_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">                e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">last_name</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">                e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">job_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">                e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">            employees e1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">            employees e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">where</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">           e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">employee_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">manager_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><p>方式三:</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       job_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> manager_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                       FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees);</span></span></code></pre></div><p><strong>题目：查询departments表中，不存在于employees表中的部门的department_id和department_name:</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       department_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   departments d</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">X</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                   FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                   WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><h3 id="_4-4-相关更新" tabindex="-1"><a class="header-anchor" href="#_4-4-相关更新"><span>4.4 相关更新</span></a></h3><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> table1 alias1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    COLUMN </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> expression</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   table2 alias2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                 WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  alias1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">COLUMN</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> alias2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">COLUMN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><p>使用相关子查询依据一个表中的数据更新另一个表的数据。</p><p><strong>题目：在employees中增加一个department_name字段，数据为员工对应的部门名称:</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"># </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">） </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(department_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">14</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"># </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">） </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees e</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    department_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                          FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   departments d</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                          WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  e</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><h3 id="_4-4-相关删除" tabindex="-1"><a class="header-anchor" href="#_4-4-相关删除"><span>4.4 相关删除</span></a></h3><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DELETE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   table1 alias1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  COLUMN operator</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">          SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> expression</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">          FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   table2 alias2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">          WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  alias1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">COLUMN</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> alias2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">COLUMN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><p>使用相关子查询依据一个表中的数据删除另一个表的数据。</p><p><strong>题目：删除表employees中，其与 emp_history 表皆有的数据:</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DELETE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees e</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                       FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   emp_history</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">                       WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">employee_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><h2 id="_5-思考题" tabindex="-1"><a class="header-anchor" href="#_5-思考题"><span>5. 思考题</span></a></h2><p><strong>问题</strong>： 谁的工资比Abel的高？</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#方式1：自连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">last_name</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">       e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees e1,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       employees e2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">last_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">Abel</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AND</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    e1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">salary</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">salary</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#方式2：子查询</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">              SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">              FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">              WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">Abel</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span></code></pre></div><p><strong>问题</strong>： 以上两种方式有好坏之分吗？</p><p>解答： 自连接方式好</p><p>题目中可以使用子查询，也可以使用自连接。一般情况建议你使用自连接，因为在许多 DBMS 的处理过程中，对于自连接的处理速度要比子查询快得多。</p><p>可以这样理解：子查询实际上是通过未知表进行查询后的条件判断，而自连接是通过已知的自身数据表进行条件判断，因此在大部分 DBMS 中都对自连接处理进行了优化。</p>`,116)])])}const e=i(l,[["render",k]]),d=JSON.parse('{"path":"/mysql/4fsjd16k/","title":"第09章_子查询","lang":"zh-CN","frontmatter":{"title":"第09章_子查询","createTime":"2025/09/02 13:34:33","permalink":"/mysql/4fsjd16k/","description":"子查询指一个查询语句嵌套在另一个查询语句内部的查询，这个特性从MySQL 4.1 开始引入。 SQL 中子查询的使用大大增强了 SELECT 查询的能力，因为很多时候查询需要从结果集中获取数据，或者需要从同一个表中先计算得出一个数据结果，然后与这个数据结果（可能是某个标量，也可能是某个集合）进行比较。 1. 需求分析与问题解决 1.1 实际问题 现有解...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"第09章_子查询\\",\\"image\\":[\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062300-b80df077-2fe3-4e2b-a7fa-90e866884e10.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062386-bb48a089-53d7-4ab5-944b-c1f77392fe1e.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062455-309cfec4-c741-4f76-845d-8c461fe6240f.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062544-dd49a58f-1a75-4e97-badc-9b1ea73a272e.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062599-9320291d-b516-4ea1-9ee9-2704cba0dd91.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062649-8503905e-c6a0-47c5-920f-7aa65ac2e19d.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062704-187a1b29-d61a-4dea-b9d6-f757b6febd2e.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062757-3be27e91-9fc7-46ae-b95a-bcf3d3a495eb.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062833-c9c822c6-a993-41fa-9029-7ea6fc88c987.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062909-b392c05c-1718-4108-a027-3ab2ad0576b9.png\\",\\"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062972-9d73384a-e4ab-4347-811e-0ac1a8cfa260.png\\"],\\"dateModified\\":\\"2025-09-02T05:35:59.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://weew12.github.io/mysql/4fsjd16k/"}],["meta",{"property":"og:site_name","content":"WEEW12 BLOG"}],["meta",{"property":"og:title","content":"第09章_子查询"}],["meta",{"property":"og:description","content":"子查询指一个查询语句嵌套在另一个查询语句内部的查询，这个特性从MySQL 4.1 开始引入。 SQL 中子查询的使用大大增强了 SELECT 查询的能力，因为很多时候查询需要从结果集中获取数据，或者需要从同一个表中先计算得出一个数据结果，然后与这个数据结果（可能是某个标量，也可能是某个集合）进行比较。 1. 需求分析与问题解决 1.1 实际问题 现有解..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.nlark.com/yuque/0/2025/png/2447732/1756791062300-b80df077-2fe3-4e2b-a7fa-90e866884e10.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-02T05:35:59.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-02T05:35:59.000Z"}]]},"readingTime":{"minutes":8.04,"words":2413},"git":{"createdTime":1756791359000,"updatedTime":1756791359000,"contributors":[{"name":"weew12","username":"weew12","email":"2528566339@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/weew12?v=4","url":"https://github.com/weew12"}]},"autoDesc":true,"filePathRelative":"notes/database/mysql/第09章_子查询.md","headers":[]}');export{e as comp,d as data};
