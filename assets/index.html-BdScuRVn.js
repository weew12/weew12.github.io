import{_ as i,c as a,a as h,o as n}from"./app-BSNvt_MX.js";const l={};function k(p,s){return n(),a("div",null,[...s[0]||(s[0]=[h(`<p><strong>MySQL从 5.0 版本开始支持存储过程和函数。</strong> 存储过程和函数能够将复杂的SQL逻辑封装在一起，应用程序无须关注存储过程和函数内部复杂的SQL逻辑，而只需要简单地调用存储过程和函数即可。</p><h2 id="_1-存储过程概述" tabindex="-1"><a class="header-anchor" href="#_1-存储过程概述"><span>1. 存储过程概述</span></a></h2><h3 id="_1-1-理解" tabindex="-1"><a class="header-anchor" href="#_1-1-理解"><span>1.1 理解</span></a></h3><p><strong>含义</strong> ：存储过程的英文是 <code>Stored Procedure</code>。它的思想很简单，就是一组经过<strong>预先编译</strong>的 SQL 语句的封装。</p><p>执行过程：存储过程预先存储在 MySQL 服务器上，需要执行的时候，客户端只需要向服务器端发出调用存储过程的命令，服务器端就可以把预先存储好的这一系列 SQL 语句全部执行。</p><p><strong>好处</strong> ：</p><ul><li>1 、简化操作，提高了<code>sql</code>语句的重用性，减少了开发程序员的压力</li><li>2 、减少操作过程中的失误，提高效率</li><li>3 、减少网络传输量（客户端不需要把所有的 SQL 语句通过网络发给服务器）</li><li>4 、减少了 SQL 语句暴露在网上的风险，也提高了数据查询的安全性</li></ul><p><strong>和视图、函数的对比</strong> ：</p><p>它和视图有着同样的优点，清晰、安全，还可以减少网络传输量。不过它和视图不同，<strong>视图是虚拟表</strong>，通常不对底层数据表直接操作，而<strong>存储过程是程序化的 SQL，可以直接操作底层数据表</strong>，相比于面向集合的操作方式，能够实现一些更复杂的数据处理。</p><p>一旦存储过程被创建出来，使用它就像使用函数一样简单，我们直接通过调用存储过程名即可。<strong>相较于函数，存储过程是没有返回值的。</strong></p><h3 id="_1-2-分类" tabindex="-1"><a class="header-anchor" href="#_1-2-分类"><span>1.2 分类</span></a></h3><p>存储过程的参数类型可以是<code>IN</code>、<code>OUT</code>和<code>INOUT</code>。根据这点分类如下：</p><ul><li>1 、没有参数（无参数无返回）</li><li>2 、仅仅带 <code>IN</code> 类型（有参数无返回）</li><li>3 、仅仅带 <code>OUT</code> 类型（无参数有返回）</li><li>4 、既带 <code>IN</code> 又带 <code>OUT</code>（有参数有返回）</li><li>5 、带 <code>INOUT</code>（有参数有返回）</li></ul><p>注意：<code>IN</code>、<code>OUT</code>、<code>INOUT</code> 都可以在一个存储过程中带多个</p><h2 id="_2-创建存储过程" tabindex="-1"><a class="header-anchor" href="#_2-创建存储过程"><span>2. 创建存储过程</span></a></h2><h3 id="_2-1-语法分析" tabindex="-1"><a class="header-anchor" href="#_2-1-语法分析"><span>2.1 语法分析</span></a></h3><p>语法：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 存储过程名 (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OUT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | INOUT 参数名 参数类型,...)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">[ characteristics...]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    存储过程体</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span></span></code></pre></div><p>类似于Java中的方法：</p><div class="language-java" data-highlighter="shiki" data-ext="java" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">修饰符 返回类型 方法名 </span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">参数类型 参数名</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">,...)</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 方法体</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">}</span></span></code></pre></div><p>说明:</p><p>1 、参数前面的符号的意思</p><ul><li><code>IN</code>：当前参数为输入参数，也就是表示<strong>入参</strong><br> 存储过程只是读取这个参数的值。如果没有定义参数种类，<strong>默认就是</strong><code>IN</code>，表示输入参数</li><li><code>OUT</code>：当前参数为输出参数，也就是表示<strong>出参</strong><br> 执行完成之后，调用这个存储过程的客户端或者应用程序就可以读取这个参数返回的值了</li><li><code>INOUT</code>：当前参数既可以为输入参数，也可以为输出参数</li></ul><p>2 、形参类型可以是 MySQL 数据库中的任意类型。</p><p>3 、<code>characteristics</code> 表示创建存储过程时<strong>指定的对存储过程的约束条件</strong>，其取值信息如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">LANGUAGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">| [NOT] DETERMINISTIC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">| { CONTAINS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">no</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | READS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | MODIFIES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">| </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> security</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> { definer | invoker }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">| comment </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">string</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span></code></pre></div><ul><li><code>LANGUAGE SQL</code>：说明存储过程<strong>执行体是由SQL语句组成的</strong>，当前系统支持的语言为SQL</li><li><code>[NOT] DETERMINISTIC</code>：指明存储过程<strong>执行的结果是否确定</strong>。<code>DETERMINISTIC</code>表示结果是<strong>确定的</strong>。每次执行存储过程时，相同的输入会得到相同的输出。<code>NOT DETERMINISTIC</code>表示结果是<strong>不确定的</strong>，相同的输入可能得到不同的输出。如果没有指定任意一个值，<strong>默认为</strong><code>NOT DETERMINISTIC</code></li><li><code>{ CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }</code>：<strong>指明子程序使用SQL语句的限制</strong><ul><li><code>CONTAINS SQL</code>表示当前存储过程的子程序包含SQL语句，但是并不包含读写数据的SQL语句</li><li><code>NO SQL</code>表示当前存储过程的子程序中不包含任何SQL语句</li><li><code>READS SQL DATA</code>表示当前存储过程的子程序中包含读数据的SQL语句</li><li><code>MODIFIES SQL DATA</code>表示当前存储过程的子程序中包含写数据的SQL语句</li><li>默认情况下，系统会指定为<code>CONTAINS SQL</code></li></ul></li><li><code>SQL SECURITY { DEFINER | INVOKER }</code>：执行当前存储过程的权限，即指明哪些用户能够执行当前存储过程 <ul><li><code>DEFINER</code>表示只有当前存储过程的<strong>创建者或者定义者</strong>才能执行当前存储过程</li><li><code>INVOKER</code>表示<strong>拥有当前存储过程的访问权限的用户</strong>能够执行当前存储过程</li><li>如果没有设置相关的值，则MySQL<strong>默认</strong>指定值为<code>DEFINER</code>。</li></ul></li><li><code>COMMENT &#39;string&#39;</code>：注释信息，可以用来描述存储过程。</li></ul><p>4 、存储过程体中可以有多条 SQL 语句，如果仅仅一条SQL 语句，则可以省略 <code>BEGIN</code> 和 <code>END</code></p><p>编写存储过程并不是一件简单的事情，可能存储过程中需要复杂的 SQL 语句。</p><ul><li>1.<code>BEGIN...END</code>：<code>BEGIN...END</code> 中间包含了多个语句，每个语句都以<code>;</code>号为结束符。</li><li>2.<code>DECLARE</code>：<code>DECLARE</code> 用来声明变量，使用的位置在于 <code>BEGIN...END</code> 语句中间，而且需要在其他语句使用之前进行变量的声明。</li><li>3.<code>SET</code>：赋值语句，用于对变量进行赋值。</li><li>4.<code>SELECT...INTO</code>：把从数据表中查询的结果存放到变量中，也就是为<strong>变量赋值</strong>。</li></ul><p>5 、需要设置新的结束标记</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER 新的结束标记</span></span></code></pre></div><p><strong>因为MySQL默认的语句结束符号为分号</strong><code>;</code><strong>。为了避免与存储过程中SQL语句结束符相冲突，需要使用</strong><code>DELIMITER</code><strong>改变存储过程的结束符。</strong></p><p>比如：</p><p>“<code>DELIMITER //</code>”语句的作用是将MySQL的结束符设置为<code>//</code>，并以“<code>END //</code>”结束存储过程。存储过程定义完毕之后再使用“<code>DELIMITER ;</code>”恢复默认结束符。<code>DELIMITER</code>也可以指定其他符号作为结束符。</p><p>当使用<code>DELIMITER</code>命令时，应该避免使用反斜杠（<code>\\</code>）字符，<strong>因为反斜线是MySQL的转义字符</strong>。</p><p>示例：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER $</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 存储过程名 ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OUT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | INOUT 参数名 参数类型,...)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">[ characteristics...] </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> SQL语句 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> SQL语句 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> $</span></span></code></pre></div><h3 id="_2-2-代码举例" tabindex="-1"><a class="header-anchor" href="#_2-2-代码举例"><span>2.2 代码举例</span></a></h3><p>测试数据：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 创建员工表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> employees</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    eid </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    ename </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">DECIMAL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    MID </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;"> -- 经理ID（用于举例7）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 插入示例数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees (ename, salary, MID) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">张三</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">8500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),     </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 总经理，没有上级</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">李四</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">7500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),       </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 向张三汇报</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">王五</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">9200</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),       </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 向张三汇报</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">赵六</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">6800</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),       </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 向李四汇报</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">钱七</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">8900</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);       </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 向王五汇报</span></span></code></pre></div><p>举例 1 ：创建存储过程<code>select_all_data()</code>，查看 <code>employees</code> 表的所有数据</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER $</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> select_all_data</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> $</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">call</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> select_all_data</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----+-------+---------+------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> eid</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> ename</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> salary</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> MID</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----+-------+---------+------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 张三</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 8500.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 李四</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 7500.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 王五</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 9200.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 赵六</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 6800.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 钱七</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 8900.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----+-------+---------+------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">5</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>举例 2 ：创建存储过程<code>avg_employee_salary()</code>，返回所有<code>employees</code>员工的平均工资</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> avg_employee_salary</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">        AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> avg_salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">        employees;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">call</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> avg_employee_salary</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> avg_salary</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 8180.000000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>举例 3 ：创建存储过程<code>show_max_salary()</code>，用来查看“<code>employees</code>”表的最高薪资值。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> show_max_salary</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> LANGUAGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NOT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> DETERMINISTIC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> CONTAINS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SECURITY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> DEFINER</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> COMMENT </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">查看最高薪资</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">   MAX</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">call</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> show_max_salary</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> MAX(salary</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     9200.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> warning</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>举例 4 ：创建存储过程<code>show_min_salary()</code>，查看“<code>employees</code>”表的最低薪资值。并将最低薪资通过<code>OUT</code>参数“<code>ms</code>” 输出</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> show_min_salary(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OUT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ms DOUBLE)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">   MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ms </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @min_salary</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">CALL</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> show_min_salary</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">@min_salary</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @min_salary</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> AS</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 最低薪资</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 最低薪资</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     6800</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>举例 5 ：创建存储过程<code>show_someone_salary()</code>，查看“<code>employees</code>”表的某个员工的薪资，并用<code>IN</code>参数 <code>empname</code> 输入员工姓名。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> show_someone_salary(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> empname </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   salary </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   ename </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> empname;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">CALL</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> show_someone_salary</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">&#39;李四&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> salary</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 7500.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>举例 6 ：创建存储过程<code>show_someone_salary2()</code>，查看“<code>employees</code>”表的某个员工的薪资，并用<code>IN</code>参数 <code>empname</code> 输入员工姓名，用<code>OUT</code>参数<code>empsalary</code>输出员工薪资。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> show_someone_salary2(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> empname </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OUT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> empsalary DOUBLE)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   salary </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  INTO</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   empsalary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   ename </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> empname;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @emp_salary</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">CALL</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> show_someone_salary2</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">&#39;王五&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @emp_salary</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @emp_salary</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> AS</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 王五的薪资</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 王五的薪资</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       9200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>举例 7 ：创建存储过程<code>show_mgr_name()</code>，查询某个员工领导的姓名，并用<code>INOUT</code>参数“<code>empname</code>”输入员工姓名，输出领导的姓名。<br> 补充：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 需要先创建emps表（与employees结构相同）并插入数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> emps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> LIKE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> emps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees;</span></span></code></pre></div><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> show_mgr_name(INOUT empname </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   ename </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   empname</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   emps</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   eid </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     MID </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     employees </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     ename </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> empname</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   );</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @emp_name</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">李四</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">CALL</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> show_mgr_name</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">@emp_name</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @emp_name</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> AS</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 李四的领导</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 李四的领导</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 张三</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h2 id="_3-调用存储过程" tabindex="-1"><a class="header-anchor" href="#_3-调用存储过程"><span>3. 调用存储过程</span></a></h2><h3 id="_3-1-调用格式" tabindex="-1"><a class="header-anchor" href="#_3-1-调用格式"><span>3.1 调用格式</span></a></h3><p>存储过程有多种调用方法。存储过程必须使用<code>CALL</code>语句调用，并且存储过程和数据库相关，如果要执行其他数据库中的存储过程，需要指定数据库名称，例如<code>CALL dbname.procname</code>。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 存储过程名(实参列表)</span></span></code></pre></div><p><strong>格式：</strong></p><p>1 、调用<code>in</code>模式的参数：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sp1(</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">值</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><p>2 、调用<code>out</code>模式的参数：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> @name;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sp1(@name);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> @name;</span></span></code></pre></div><p>3 、调用<code>inout</code>模式的参数：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> @name</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">值;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CALL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sp1(@name);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> @name;</span></span></code></pre></div><h3 id="_3-2-代码举例" tabindex="-1"><a class="header-anchor" href="#_3-2-代码举例"><span>3.2 代码举例</span></a></h3><p>举例 1:</p><p>测试数据：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 创建水果表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> fruits</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    f_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,          </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 水果ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    f_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,    </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 水果名称</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    f_price </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">DECIMAL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),           </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 水果价格</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    s_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">                        -- 供应商ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 插入示例数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> fruits (f_id, f_name, f_price, s_id) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">苹果</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">101</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">香蕉</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">101</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">橙子</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">101</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">西瓜</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">102</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">葡萄</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">102</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">芒果</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">103</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">菠萝</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">103</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">草莓</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">101</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">9</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">樱桃</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">104</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">桃子</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">102</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> CountProc ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> sid</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OUT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> num </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">   COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> num </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   fruits </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   s_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> sid</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER;</span></span></code></pre></div><p>调用存储过程：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">set</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @sid</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 101</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">set</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @num</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">call</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> CountProc</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">@sid,</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @num</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">select</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @num</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> @num</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>该存储过程返回了指定 <code>s_id=101</code> 的水果商提供的水果种类，返回值存储在<code>num</code>变量中，使用<code>SELECT</code>查看，返回结果为 4 。</p><p><strong>举例 2 ：</strong> 创建存储过程，实现累加运算，计算 <code>1+2+...+n</code> 等于多少。</p><p>具体的代码如下：</p><p>如果你用的是 <code>Navicat</code> 工具，那么在编写存储过程的时候，<code>Navicat</code> 会自动设置 <code>DELIMITER</code> 为其他符号，我们不需要再进行 <code>DELIMITER</code> 的操作。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> add_num(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OUT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    DECLARE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    DECLARE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sum_val </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">; </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 避免使用sum，它是MySQL的保留字</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sum_val </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    WHILE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&lt;=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> n DO</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">        SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sum_val </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sum_val </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> i;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">        SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    END</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> WHILE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> res </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sum_val; </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 将结果赋值给OUT参数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><p>直接使用 <code>CALL add_num(50);</code>即可。这里我传入的参数为 <code>50</code> ，也就是统计 <code>1+2+...+50</code> 的积累之和。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @result</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">CALL</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> add_num</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">50,</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @result</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @result</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> @result</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    1275</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h3 id="_3-3-如何调试" tabindex="-1"><a class="header-anchor" href="#_3-3-如何调试"><span>3.3 如何调试</span></a></h3><p>在 MySQL 中，存储过程不像普通的编程语言（比如 VC++、Java 等）那样有专门的集成开发环境。因此，你可以通过 <code>SELECT</code> 语句，把程序执行的中间结果查询出来，来调试一个 SQL 语句的正确性。调试成功之后，把 SELECT 语句后移到下一个 SQL 语句之后，再调试下一个 SQL 语句。这样<strong>逐步推进</strong>，就可以完成对存储过程中所有操作的调试了。当然，你也可以把存储过程中的 SQL 语句复制出来，逐段单独调试。</p><h2 id="_4-存储函数-stored-function的使用" tabindex="-1"><a class="header-anchor" href="#_4-存储函数-stored-function的使用"><span>4. 存储函数 Stored Function的使用</span></a></h2><p>前面学习了很多函数，使用这些函数可以对数据进行的各种处理操作，极大地提高用户对数据库的管理效率。MySQL支持自定义函数，定义好之后，调用方式与调用MySQL预定义的系统函数一样。</p><h3 id="_4-1-语法分析" tabindex="-1"><a class="header-anchor" href="#_4-1-语法分析"><span>4.1 语法分析</span></a></h3><p>学过的函数：<code>LENGTH</code>、<code>SUBSTR</code>、<code>CONCAT</code>等</p><p>语法格式：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FUNCTION</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> 函数名</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(参数名 参数类型,...)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">RETURNS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 返回值类型</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">[ characteristics...]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 函数体 </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 函数体中肯定有</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 语句 </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span></span></code></pre></div><p>说明：</p><p>1 、<strong>参数列表</strong>：指定参数为<code>IN</code>、<code>OUT</code>或<code>INOUT</code>只对<code>PROCEDURE</code>是合法的，<code>FUNCTION</code><strong>中总是默认为</strong><code>IN</code><strong>参数</strong><br> 2 、<code>RETURNS type</code> 语句表示函数返回数据的类型；<br><code>RETURNS</code>子句只能对<code>FUNCTION</code>做指定，对函数而言这是强制的。它用来指定函数的返回类型，而且函数体必须包含一个<code>RETURN value</code>语句。<br> 3 、<code>characteristic</code> 创建函数时指定的对函数的约束。<strong>取值与创建存储过程时相同</strong>，这里不再赘述。<br> 4 、函数体也可以用<code>BEGIN...END</code>来表示SQL代码的开始和结束。如果函数体只有一条语句，也可以省略<code>BEGIN...END</code>。</p><h3 id="_4-2-调用存储函数" tabindex="-1"><a class="header-anchor" href="#_4-2-调用存储函数"><span>4.2 调用存储函数</span></a></h3><p><strong>在MySQL中，存储函数的使用方法与MySQL内部函数的使用方法是一样的</strong>。换言之，用户自己定义的存储函数与MySQL内部函数是一个性质的。区别在于，存储函数是用户自己定义的，而内部函数是MySQL的开发者定义的。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 函数名(实参列表)</span></span></code></pre></div><h3 id="_4-3-代码举例" tabindex="-1"><a class="header-anchor" href="#_4-3-代码举例"><span>4.3 代码举例</span></a></h3><p><strong>举例 1：</strong><br> 创建存储函数，名称为<code>email_by_name()</code>，参数定义为空，该函数查询<code>Abel</code>的<code>email</code>，并返回，数据类型为字符串型。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FUNCTION</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> email_by_name</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">RETURNS</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DETERMINISTIC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">CONTAINS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   email</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   last_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">Abel</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><p>调用：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> email_by_name</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> email_by_name</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> EABEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">           |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p><strong>举例 2：</strong><br> 创建存储函数，名称为<code>email_by_id()</code>，参数传入<code>emp_id</code>，该函数查询<code>emp_id</code>的<code>email</code>，并返回，数据类型为字符串型。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FUNCTION</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> email_by_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(emp_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">RETURNS</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DETERMINISTIC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">CONTAINS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   email</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> emp_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><p>调用：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @emp_id</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 102</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> email_by_id</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 102</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;"> );</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> email_by_id(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 102</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> LDEHAAN</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">            |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+--------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p><strong>举例 3：</strong><br> 创建存储函数<code>count_by_id()</code>，参数传入<code>dept_id</code>，该函数查询<code>dept_id</code>部门的员工人数，并返回，数据类型为整型。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FUNCTION</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> count_by_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(dept_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">RETURNS</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> INT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">LANGUAGE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">NOT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> DETERMINISTIC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">READS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> DATA</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SECURITY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> DEFINER</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">COMMENT </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">查询部门平均工资</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">   COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> dept_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><p>调用：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SET</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> @dept_id</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> count_by_id</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">@dept_id</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">Query</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> OK,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> affected</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> count_by_id(@dept_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                    45</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> warning</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>注意：</p><p>若在创建存储函数中报错“<code>you might want to use the less safe log_bin_trust_function_creators variable</code>”，有两种处理方法：</p><ul><li>方式 1 ：加上必要的函数特性“<code>[NOT] DETERMINISTIC</code>”和“<code>{CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA}</code>”</li><li>方式 2 ：</li></ul><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> GLOBAL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> log_bin_trust_function_creators </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ;</span></span></code></pre></div><p>补充：<br><code>SET GLOBAL log_bin_trust_function_creators = 1;</code> 这条 MySQL 命令用于放宽对存储函数（Stored Function）和触发器（Trigger）创建的严格安全检查，主要是在服务器启用了二进制日志（binary logging）的情况下。下面我们来详细解读它的作用和注意事项。<strong>参数含义与作用</strong>：</p><table><thead><tr><th>参数状态 (Value)</th><th>含义与影响</th><th>适用场景</th></tr></thead><tbody><tr><td><strong>1 (或 ON)</strong></td><td><strong>信任函数创建者</strong>。允许用户创建或修改存储函数/触发器，而无需具有 <code>SUPER</code> 权限，也无需强制函数声明为 <code>DETERMINISTIC</code> 等特性。</td><td>开发环境、无主从复制的生产环境、或完全信任所有具有 <code>CREATE ROUTINE</code> 权限的用户的环境。</td></tr><tr><td><strong>0 (或 OFF，默认值)</strong></td><td><strong>严格模式</strong>。用户必须具有 <code>SUPER</code> 权限才能创建或修改存储函数/触发器，或者必须将函数声明为 <code>DETERMINISTIC</code>、<code>NO SQL</code> 或 <code>READS SQL DATA</code> 之一。</td><td><strong>默认设置</strong>。注重安全性和数据一致性的环境，尤其是使用了<strong>主从复制</strong>的生产环境。</td></tr></tbody></table><h3 id="_4-4-对比存储函数和存储过程" tabindex="-1"><a class="header-anchor" href="#_4-4-对比存储函数和存储过程"><span>4.4 对比存储函数和存储过程</span></a></h3><table><thead><tr><th></th><th>关键字</th><th>调用语法</th><th>返回值</th><th>应用场景</th></tr></thead><tbody><tr><td>存储过程</td><td><code>PROCEDURE</code></td><td><code>CALL 存储过程()</code></td><td>理解为有 <code>0</code> 个或多个</td><td>一般用于更新</td></tr><tr><td>存储函数</td><td><code>FUNCTION</code></td><td><code>SELECT 函数()</code></td><td><strong>只能是一个</strong></td><td>一般用于查询结果为一个值并返回时</td></tr></tbody></table><p>此外， <strong>存储函数可以放在查询语句中使用，存储过程不行</strong>。反之，存储过程的功能更加强大，包括能够执行对表的操作（比如创建表，删除表等）和事务操作，这些功能是存储函数不具备的</p><h2 id="_5-存储过程和函数的查看、修改、删除" tabindex="-1"><a class="header-anchor" href="#_5-存储过程和函数的查看、修改、删除"><span>5. 存储过程和函数的查看、修改、删除</span></a></h2><h3 id="_5-1-查看" tabindex="-1"><a class="header-anchor" href="#_5-1-查看"><span>5.1 查看</span></a></h3><p>创建完之后，怎么知道我们创建的存储过程、存储函数是否成功了呢？</p><p>MySQL存储了存储过程和函数的状态信息，用户可以使用<code>SHOW STATUS</code>语句或<code>SHOW CREATE</code>语句来查看，也可直接从系统的<code>information_schema</code>数据库中查询。这里介绍 <code>3</code> 种方法：</p><p><strong>1.使用</strong><code>SHOW CREATE</code><strong>语句查看存储过程和函数的创建信息：</strong></p><p>基本语法结构如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">} 存储过程名或函数名</span></span></code></pre></div><p>举例：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FUNCTION</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> test_db</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">CountProc</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> \\G</span></span></code></pre></div><p><strong>2.使用</strong><code>SHOW STATUS</code><strong>语句查看存储过程和函数的状态信息</strong>:</p><p>基本语法结构如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">SHOW {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">STATUS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> [LIKE &#39;pattern&#39;]</span></span></code></pre></div><p>这个语句返回子程序的特征，如数据库、名字、类型、创建者及创建和修改日期</p><p><code>[LIKE &#39;pattern&#39;]</code>：匹配存储过程或函数的名称，可以省略。<strong>当省略不写时，会列出MySQL数据库中存在的所有存储过程或函数的信息。</strong> 举例：<code>SHOW STATUS</code>语句示例，代码如下：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> PROCEDURE</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT%</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> \\G</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 1. row </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                  Db:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> atguigudb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                Name:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> select_all_data</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                Type:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> PROCEDURE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Definer:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> root@localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            Modified:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 2025-09-06</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 09:52:45</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Created:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 2025-09-06</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 09:52:45</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       Security_type:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> DEFINER</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Comment:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">character_set_client:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">collation_connection:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk_chinese_ci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  Database</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> Collation:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> utf8mb3_general_ci</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 2. row </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                  Db:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> atguigudb1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                Name:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> select_all_data</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                Type:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> PROCEDURE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Definer:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> root@localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            Modified:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 2025-09-06</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 10:25:53</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Created:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 2025-09-06</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 10:25:53</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       Security_type:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> DEFINER</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Comment:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">character_set_client:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">collation_connection:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk_chinese_ci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  Database</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> Collation:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> utf8mb4_0900_ai_ci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p><strong>3.从information_schema.Routines表中查看存储过程和函数的信息</strong>:</p><p>MySQL中存储过程和函数的信息存储在<code>information_schema</code>数据库下的<code>Routines</code>表中。可以通过查询该表的记录来查询存储过程和函数的信息。</p><p>其基本语法形式如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">    *</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">Routines</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    ROUTINE_NAME </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">存储过程或函数的名</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    [AND ROUTINE_TYPE = {&#39;PROCEDURE|FUNCTION&#39;}];</span></span></code></pre></div><p>说明：<strong>如果在MySQL数据库中存在存储过程和函数名称相同的情况，最好指定</strong><code>ROUTINE_TYPE</code><strong>查询条件来指明查询的是存储过程还是函数。</strong></p><p>举例：从<code>Routines</code>表中查询名称为<code>CountProc</code>的存储函数的信息，代码如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">    *</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">Routines</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    ROUTINE_NAME </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">count_by_id</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    AND</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ROUTINE_TYPE </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">FUNCTION</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> \\G</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt;     </span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">FROM</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt;     </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">information_schema.Routines</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt;     </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">ROUTINE_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">count_by_id</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt;     </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">AND</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> ROUTINE_TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">FUNCTION</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> \\G</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 1. row </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           SPECIFIC_NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> count_by_id</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         ROUTINE_CATALOG:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> def</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          ROUTINE_SCHEMA:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> atguigudb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            ROUTINE_NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> count_by_id</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            ROUTINE_TYPE:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> FUNCTION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">               DATA_TYPE:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> int</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">CHARACTER_MAXIMUM_LENGTH:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> NULL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  CHARACTER_OCTET_LENGTH:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> NULL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       NUMERIC_PRECISION:</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           NUMERIC_SCALE:</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      DATETIME_PRECISION:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> NULL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      CHARACTER_SET_NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> NULL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          COLLATION_NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> NULL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          DTD_IDENTIFIER:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> int</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            ROUTINE_BODY:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      ROUTINE_DEFINITION:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> BEGIN</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">COUNT(*</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">FROM</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">employees</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">department_id</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> dept_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> )</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">END</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           EXTERNAL_NAME:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> NULL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       EXTERNAL_LANGUAGE:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         PARAMETER_STYLE:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> SQL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        IS_DETERMINISTIC:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> NO</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         SQL_DATA_ACCESS:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> READS</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> SQL</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> DATA</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                SQL_PATH:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> NULL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           SECURITY_TYPE:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> DEFINER</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                 CREATED:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 2025-09-06</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 11:30:18</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            LAST_ALTERED:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 2025-09-06</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 11:30:18</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                SQL_MODE:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         ROUTINE_COMMENT:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 查询部门平均工资</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                 DEFINER:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> root@localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    CHARACTER_SET_CLIENT:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    COLLATION_CONNECTION:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk_chinese_ci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      DATABASE_COLLATION:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> utf8mb3_general_ci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h3 id="_5-2-修改" tabindex="-1"><a class="header-anchor" href="#_5-2-修改"><span>5.2 修改</span></a></h3><p>修改存储过程或函数，不影响存储过程或函数功能，只是修改相关特性。使用<code>ALTER</code>语句实现</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ALTER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">} 存储过程或函数的名 [characteristic ...]</span></span></code></pre></div><p>其中，<code>characteristic</code>指定存储过程或函数的特性，其取值信息与创建存储过程、函数时的取值信息略有不同。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">{ CONTAINS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">NO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SQL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | READS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> DATA</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | MODIFIES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> DATA</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">| </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SECURITY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> { DEFINER | INVOKER }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">| COMMENT </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">string</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span></code></pre></div><ul><li><code>CONTAINS SQL</code>，表示子程序包含SQL语句，但不包含读或写数据的语句</li><li><code>NO SQL</code>，表示子程序中不包含SQL语句</li><li><code>READS SQL DATA</code>，表示子程序中包含读数据的语句</li><li><code>MODIFIES SQL DATA</code>，表示子程序中包含写数据的语句</li><li><code>SQL SECURITY { DEFINER | INVOKER }</code>，指明谁有权限来执行 <ul><li><code>DEFINER</code>，表示只有定义者自己才能够执行</li><li><code>INVOKER</code>，表示调用者可以执行</li></ul></li><li><code>COMMENT &#39;string&#39;</code>，表示注释信息。</li></ul><blockquote><p>修改存储过程使用<code>ALTER PROCEDURE</code>语句，修改存储函数使用<code>ALTER FUNCTION</code>语句。但是，这两个语句的结构是一样的，语句中的所有参数也是一样的</p></blockquote><p><strong>举例 1：</strong></p><p>修改存储过程<code>CountProc</code>的定义。将读写权限改为<code>MODIFIES SQL DATA</code>，并指明调用者可以执行，代码如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> CountProc</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">MODIFIES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> DATA</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SECURITY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> INVOKER ;</span></span></code></pre></div><p>查询修改后的信息：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    specific_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sql_data_access,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    security_type</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    information_schema.</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">\`</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">ROUTINES</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">\`</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    routine_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">CountProc</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    AND</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> routine_type </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">PROCEDURE</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><p>结果显示，存储过程修改成功。从查询的结果可以看出，访问数据的权限（<code>SQL_DATA_ ACCESS</code>）已经变成<code>MODIFIES SQL DATA</code>，安全类型（<code>SECURITY_TYPE</code>）已经变成<code>INVOKER</code></p><p><strong>举例 2：</strong></p><p>修改存储函数<code>CountProc</code>的定义。将读写权限改为<code>READS SQL DATA</code>，并加上注释信息“<code>FIND NAME</code>”，代码如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> CountProc</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">READS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> DATA</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">COMMENT </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">FIND NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><p>存储函数修改成功。从查询的结果可以看出，访问数据的权限（<code>SQL_DATA_ACCESS</code>）已经变成<code>READS SQL DATA</code>，函数注释（<code>ROUTINE_COMMENT</code>）已经变成<code>FIND NAME</code></p><h3 id="_5-3-删除" tabindex="-1"><a class="header-anchor" href="#_5-3-删除"><span>5.3 删除</span></a></h3><p>删除存储过程和函数，可以使用<code>DROP</code>语句，其语法结构如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DROP</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> | </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">} [IF EXISTS] 存储过程或函数的名</span></span></code></pre></div><p><code>IF EXISTS</code>：如果程序或函数不存在，它可以防止发生错误，产生一个用<code>SHOW WARNINGS</code>查看的警告</p><p>举例：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> PROCEDURE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> CountProc;</span></span></code></pre></div><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FUNCTION</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> CountProc;</span></span></code></pre></div><h2 id="_6-关于存储过程使用的争议" tabindex="-1"><a class="header-anchor" href="#_6-关于存储过程使用的争议"><span>6. 关于存储过程使用的争议</span></a></h2><p>尽管存储过程有诸多优点，但是对于存储过程的使用， <strong>一直都存在着很多争议</strong> ，比如有些公司对于大型项目要求使用存储过程，而有些公司在手册中明确禁止使用存储过程，为什么这些公司对存储过程的使用需求差别这么大呢？</p><h3 id="_6-1-优点" tabindex="-1"><a class="header-anchor" href="#_6-1-优点"><span>6.1 优点</span></a></h3><p>1 、<strong>存储过程可以一次编译多次使用</strong>。 存储过程只在创建时进行编译，之后的使用都不需要重新编译这就提升了 SQL 的执行效率<br> 2 、<strong>可以减少开发工作量</strong>。 将代码<strong>封装</strong>成模块，实际上是编程的核心思想之一，这样可以把复杂的问题拆解成不同的模块，然后模块之间可以<strong>重复使用</strong>，在减少开发工作量的同时，还能保证代码的结构清晰<br> 3 、<strong>存储过程的安全性强</strong>。 我们在设定存储过程的时候可以<strong>设置对用户的使用权限</strong>，这样就和视图一样具有较强的安全性<br> 4 、<strong>可以减少网络传输量</strong>。 因为代码封装到存储过程中，每次使用只需要调用存储过程即可，这样就减少了网络传输量<br> 5 、<strong>良好的封装性</strong>。 在进行相对复杂的数据库操作时，原本需要使用一条一条的 SQL 语句，可能要连接多次数据库才能完成的操作，现在变成了一次存储过程，<strong>只需要连接一次即可</strong></p><h3 id="_6-2-缺点" tabindex="-1"><a class="header-anchor" href="#_6-2-缺点"><span>6.2 缺点</span></a></h3><p>基于上面这些优点，不少大公司都要求大型项目使用存储过程，比如微软、IBM 等公司。但是国内的阿里并不推荐开发人员使用存储过程，这是为什么呢？</p><blockquote><p>阿里开发规范:<br> 【强制】禁止使用存储过程，存储过程难以调试和扩展，更没有移植性</p></blockquote><p>存储过程虽然有诸如上面的好处，但缺点也是很明显的</p><p><strong>1 、可移植性差。</strong> 存储过程不能跨数据库移植，比如在 <code>MySQL</code>、<code>Oracle</code> 和 <code>SQL Server</code> 里编写的存储过程，在换成其他数据库时都需要重新编写。<br><strong>2 、调试困难。</strong> 只有少数 <code>DBMS</code> 支持存储过程的调试。对于复杂的存储过程来说，开发和维护都不容易。虽然也有一些第三方工具可以对存储过程进行调试，但要收费。<br><strong>3 、存储过程的版本管理很困难。</strong> 比如数据表索引发生变化了，可能会导致存储过程失效。我们在开发软件的时候往往需要进行版本管理，但是存储过程本身没有版本控制，版本迭代更新的时候很麻烦。<br><strong>4 、它不适合高并发的场景。</strong> 高并发的场景需要减少数据库的压力，有时数据库会采用分库分表的方式，而且对可扩展性要求很高，在这种情况下，存储过程会变得难以维护，增加数据库的压力，显然就不适用了。</p><p>小结：<br> 存储过程既方便，又有局限性。尽管不同的公司对存储过程的态度不一，但是对于我们开发人员来说，不论怎样，掌握存储过程都是必备的技能之一。</p>`,180)])])}const e=i(l,[["render",k]]),d=JSON.parse('{"path":"/mysql/y0hix5xq/","title":"第15章_存储过程与函数","lang":"zh-CN","frontmatter":{"title":"第15章_存储过程与函数","createTime":"2025/09/06 12:03:06","permalink":"/mysql/y0hix5xq/","description":"MySQL从 5.0 版本开始支持存储过程和函数。 存储过程和函数能够将复杂的SQL逻辑封装在一起，应用程序无须关注存储过程和函数内部复杂的SQL逻辑，而只需要简单地调用存储过程和函数即可。 1. 存储过程概述 1.1 理解 含义 ：存储过程的英文是 Stored Procedure。它的思想很简单，就是一组经过预先编译的 SQL 语句的封装。 执行过...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"第15章_存储过程与函数\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-06T04:04:09.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://weew12.github.io/mysql/y0hix5xq/"}],["meta",{"property":"og:site_name","content":"WEEW12 BLOG"}],["meta",{"property":"og:title","content":"第15章_存储过程与函数"}],["meta",{"property":"og:description","content":"MySQL从 5.0 版本开始支持存储过程和函数。 存储过程和函数能够将复杂的SQL逻辑封装在一起，应用程序无须关注存储过程和函数内部复杂的SQL逻辑，而只需要简单地调用存储过程和函数即可。 1. 存储过程概述 1.1 理解 含义 ：存储过程的英文是 Stored Procedure。它的思想很简单，就是一组经过预先编译的 SQL 语句的封装。 执行过..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-06T04:04:09.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-06T04:04:09.000Z"}]]},"readingTime":{"minutes":21.25,"words":6376},"git":{"createdTime":1757131449000,"updatedTime":1757131449000,"contributors":[{"name":"weew12","username":"weew12","email":"2528566339@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/weew12?v=4","url":"https://github.com/weew12"}]},"autoDesc":true,"filePathRelative":"notes/database/mysql/第15章_存储过程与函数.md","headers":[]}');export{e as comp,d as data};
