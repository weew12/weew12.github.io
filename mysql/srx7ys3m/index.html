<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.24" /><meta name="theme" content="VuePress Theme Plume " /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"第17章_触发器","image":["https://cdn.nlark.com/yuque/0/2025/png/2447732/1757169644120-3c0d86b1-6a4b-4d43-bb77-fde70d415ffa.png","https://cdn.nlark.com/yuque/0/2025/png/2447732/1757169644204-273ce257-1cf7-48e0-9550-363f453f7d77.png"],"dateModified":"2025-09-06T14:48:16.000Z","author":[]}</script><meta property="og:url" content="https://weew12.github.io/mysql/srx7ys3m/"><meta property="og:site_name" content="WEEW12 BLOG"><meta property="og:title" content="第17章_触发器"><meta property="og:description" content="在实际开发中，我们经常会遇到这样的情况：有 2 个或者多个相互关联的表，如商品信息和库存信息分别存放在 2 个不同的数据表中，我们在添加一条新商品记录的时候，为了保证数据的完整性，必须同时在库存表中添加一条库存记录 这样一来，我们就必须把这两个关联的操作步骤写到程序里面，而且要用事务包裹起来，确保这两个操作成为一个原子操作，要么全部执行，要么全部不执行..."><meta property="og:type" content="article"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/png/2447732/1757169644120-3c0d86b1-6a4b-4d43-bb77-fde70d415ffa.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-09-06T14:48:16.000Z"><meta property="article:modified_time" content="2025-09-06T14:48:16.000Z"><link rel="icon" type="image/png" href="/favicon.ico"><meta name="referrer" content="no-referrer"><title>第17章_触发器 | WEEW12 BLOG</title><meta name="description" content="在实际开发中，我们经常会遇到这样的情况：有 2 个或者多个相互关联的表，如商品信息和库存信息分别存放在 2 个不同的数据表中，我们在添加一条新商品记录的时候，为了保证数据的完整性，必须同时在库存表中添加一条库存记录 这样一来，我们就必须把这两个关联的操作步骤写到程序里面，而且要用事务包裹起来，确保这两个操作成为一个原子操作，要么全部执行，要么全部不执行..."><link rel="preload" href="/assets/style-VKnRds0j.css" as="style"><link rel="stylesheet" href="/assets/style-VKnRds0j.css"><link rel="modulepreload" href="/assets/app-BO2U5m27.js"><link rel="modulepreload" href="/assets/index.html-DOXTKESO.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-27c095d7><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-f5342612></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-f5342612> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-27c095d7 data-v-ae750b7e><div class="vp-navbar" vp-navbar data-v-ae750b7e data-v-3002d082><div class="wrapper" data-v-3002d082><div class="container" data-v-3002d082><div class="title" data-v-3002d082><div class="vp-navbar-title has-sidebar" data-v-3002d082 data-v-666dade2><a class="vp-link link no-icon title" href="/" data-v-666dade2><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="/logo.png" alt data-v-bc1f2c6d><!--]--><!--[--><img class="vp-image light logo" style="" src="/logo.png" alt data-v-bc1f2c6d><!--]--><!--]--><!--]--><span data-v-666dade2>WEEW12 BLOG</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-3002d082><div class="content-body" data-v-3002d082><!--[--><!--]--><div class="vp-navbar-search search" data-v-3002d082><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-3002d082 data-v-de5fb40d><span id="main-nav-aria-label" class="visually-hidden" data-v-de5fb40d>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>博客</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/tags/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>标签</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/categories/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>分类</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/archives/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>归档</span><!----><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-de5fb40d data-v-4393febb><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-4393febb><span class="text" data-v-4393febb><!----><!----><span data-v-4393febb>笔记</span><!----><span class="vpi-chevron-down text-icon" data-v-4393febb></span></span></button><div class="menu" data-v-4393febb><div class="vp-menu" data-v-4393febb data-v-471c6636><div class="items" data-v-471c6636><!--[--><!--[--><div class="vp-menu-group" data-v-471c6636 data-v-1ee9ef5f><p class="title" data-v-1ee9ef5f><!----><span data-v-1ee9ef5f>后端</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-1ee9ef5f data-v-04daa31f><a class="vp-link link" href="/language/java/1pj4wq5u/" data-v-04daa31f><!--[--><!----> 语言基础 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-1ee9ef5f data-v-04daa31f><a class="vp-link link" href="/framework/heima_ssm_book/r3rcs5o0/" data-v-04daa31f><!--[--><!----> 框架相关 <span class="vp-badge tip vp-menu-badge" style="" data-v-04daa31f data-v-26900783><!--[-->new<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="vp-menu-group" data-v-471c6636 data-v-1ee9ef5f><p class="title" data-v-1ee9ef5f><!----><span data-v-1ee9ef5f>数据库</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-1ee9ef5f data-v-04daa31f><a class="vp-link link" href="/mysql/q449w0j5/" data-v-04daa31f><!--[--><!----> MYSQL <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-3002d082 data-v-07ea9724><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-07ea9724 data-v-4b98d79f data-v-51d980cd><span class="check" data-v-51d980cd><span class="icon" data-v-51d980cd><!--[--><span class="vpi-sun sun" data-v-4b98d79f></span><span class="vpi-moon moon" data-v-4b98d79f></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-3002d082 data-v-99a107d5 data-v-3ad50ecc><!--[--><a class="vp-social-link no-icon" href="https://github.com/weew12" aria-label="github" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-github" /></a><a class="vp-social-link no-icon" href="mailto:2528566339@qq.com" aria-label="qq" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-qq" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-3002d082 data-v-d8b05a8e data-v-4393febb><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-4393febb><span class="vpi-more-horizontal icon" data-v-4393febb></span></button><div class="menu" data-v-4393febb><div class="vp-menu" data-v-4393febb data-v-471c6636><!----><!--[--><!--[--><!----><div class="group" data-v-d8b05a8e><div class="item appearance" data-v-d8b05a8e><p class="label" data-v-d8b05a8e>外观</p><div class="appearance-action" data-v-d8b05a8e><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-d8b05a8e data-v-4b98d79f data-v-51d980cd><span class="check" data-v-51d980cd><span class="icon" data-v-51d980cd><!--[--><span class="vpi-sun sun" data-v-4b98d79f></span><span class="vpi-moon moon" data-v-4b98d79f></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d8b05a8e><div class="item social-links" data-v-d8b05a8e><div class="vp-social-links social-links-list" data-v-d8b05a8e data-v-3ad50ecc><!--[--><a class="vp-social-link no-icon" href="https://github.com/weew12" aria-label="github" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-github" /></a><a class="vp-social-link no-icon" href="mailto:2528566339@qq.com" aria-label="qq" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-qq" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-3002d082 data-v-e5558799><span class="container" data-v-e5558799><span class="top" data-v-e5558799></span><span class="middle" data-v-e5558799></span><span class="bottom" data-v-e5558799></span></span></button></div></div></div></div><div class="divider" data-v-3002d082><div class="divider-line" data-v-3002d082></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-27c095d7 data-v-b0433a68><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-b0433a68><span class="vpi-align-left menu-icon" data-v-b0433a68></span><span class="menu-text" data-v-b0433a68>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-b0433a68 data-v-358fac30><button data-v-358fac30>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-27c095d7 data-v-fd62cea1><div class="curtain" data-v-fd62cea1></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-fd62cea1><span id="sidebar-aria-label" class="visually-hidden" data-v-fd62cea1> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-e274f709><section class="vp-sidebar-item sidebar-item level-0 collapsible has-active" data-v-e274f709 data-v-994e26d4><div class="item" role="button" tabindex="0" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><h2 class="text" data-v-994e26d4><span data-v-994e26d4>MYSQL</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-994e26d4><span class="vpi-chevron-right caret-icon" data-v-994e26d4></span></div></div><div data-v-994e26d4 data-v-994e26d4><div class="items" data-v-994e26d4><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/q449w0j5/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第00章_写在前面</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/o4l8p4jd/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第01章_数据库概述</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/o5yp3vh2/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第02章_MySQL环境搭建</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/p5uvykat/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第03章_基本的SELECT语句</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/qxt7xq29/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第04章_运算符</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/wmtsc974/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第05章_排序与分页</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/aolb36wf/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第06章_多表查询</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/c0jgzz2u/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第07章_单行函数</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/9an63vlq/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第08章_聚合函数</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/4fsjd16k/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第09章_子查询</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/5fre8wx1/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第10章_创建和管理表</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/aodt7kij/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第11章_数据处理之增删改</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/feuhpohs/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第12章_MySQL数据类型精讲</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/utbdi7eh/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第13章_约束</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/t5z4fo16/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第14章_视图</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/y0hix5xq/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第15章_存储过程与函数</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/wa8pqbfi/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第16章_变量、流程控制与游标</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/srx7ys3m/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第17章_触发器</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/kprca6qs/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第18章_MySQL8其它新特性</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-27c095d7 data-v-5b39a01b><div class="vp-doc-container has-sidebar has-aside" data-v-5b39a01b data-v-0d7da0a5><!--[--><!--]--><div class="container" data-v-0d7da0a5><div class="aside" vp-outline data-v-0d7da0a5><div class="aside-curtain" data-v-0d7da0a5></div><div class="aside-container" data-v-0d7da0a5><div class="aside-content" data-v-0d7da0a5><div class="vp-doc-aside" data-v-0d7da0a5 data-v-6df97c7f><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-6df97c7f data-v-3003aeb2><div class="content" data-v-3003aeb2><div class="outline-marker" data-v-3003aeb2></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-3003aeb2><span data-v-3003aeb2>目录</span><span class="vpi-print icon" data-v-3003aeb2></span></div><ul class="root" data-v-3003aeb2 data-v-f4c16ca0><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6df97c7f></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-0d7da0a5><div class="content-container" data-v-0d7da0a5><!--[--><!--]--><main class="main" data-v-0d7da0a5><nav class="vp-breadcrumb" data-v-0d7da0a5 data-v-eeb0b690><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-eeb0b690><!--[--><li property="itemListElement" typeof="ListItem" data-v-eeb0b690><a class="vp-link link breadcrumb" href="/" property="item" typeof="WebPage" data-v-eeb0b690><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-eeb0b690></span><meta property="name" content="首页" data-v-eeb0b690><meta property="position" content="1" data-v-eeb0b690></li><li property="itemListElement" typeof="ListItem" data-v-eeb0b690><span class="vp-link breadcrumb" property="item" typeof="WebPage" data-v-eeb0b690><!--[-->MYSQL<!--]--><!----></span><span class="vpi-chevron-right" data-v-eeb0b690></span><meta property="name" content="MYSQL" data-v-eeb0b690><meta property="position" content="2" data-v-eeb0b690></li><li property="itemListElement" typeof="ListItem" data-v-eeb0b690><a class="vp-link link breadcrumb current" href="/mysql/srx7ys3m/" property="item" typeof="WebPage" data-v-eeb0b690><!--[-->第17章_触发器<!--]--><!----></a><!----><meta property="name" content="第17章_触发器" data-v-eeb0b690><meta property="position" content="3" data-v-eeb0b690></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-e9ba3c81><!----> 第17章_触发器 <!----></h1><div class="vp-doc-meta" data-v-e9ba3c81><!--[--><!--]--><p class="reading-time" data-v-e9ba3c81><span class="vpi-books icon" data-v-e9ba3c81></span><span data-v-e9ba3c81>约 2576 字</span><span data-v-e9ba3c81>大约 9 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-e9ba3c81><span class="vpi-clock icon" data-v-e9ba3c81></span><span data-v-e9ba3c81>2025-09-06</span></p></div><!--]--><!--[--><!--]--><div class="_mysql_srx7ys3m_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-0d7da0a5><!--[--><!--]--><div data-v-0d7da0a5><p>在实际开发中，我们经常会遇到这样的情况：有 <code>2</code> 个或者多个相互关联的表，如<strong>商品信息</strong>和<strong>库存信息</strong>分别存放在 <code>2</code> 个不同的数据表中，我们在添加一条新商品记录的时候，为了保证数据的完整性，必须同时在库存表中添加一条库存记录</p><p>这样一来，我们就必须把这两个关联的操作步骤写到程序里面，而且要用<strong>事务</strong>包裹起来，<strong>确保这两个操作成为一个原子操作</strong>，要么全部执行，要么全部不执行。要是遇到特殊情况，可能还需要对数据进行手动维护，这样就<strong>很容易忘记其中的一步</strong>，导致数据缺失</p><p>这个时候，咱们可以使用<strong>触发器</strong>。 <strong>你可以创建一个触发器，让商品信息数据的插入操作自动触发库存数据的插入操作</strong>。 这样一来，就不用担心因为忘记添加库存数据而导致的数据缺失了</p><h2 id="_1-触发器概述" tabindex="-1"><a class="header-anchor" href="#_1-触发器概述"><span>1. 触发器概述</span></a></h2><p>MySQL从<code>5.0.2</code>版本开始支持触发器。MySQL的触发器和存储过程一样，都是嵌入到MySQL服务器的一段程序。</p><p>触发器是<strong>由事件来触发某个操作</strong>，这些事件包括<code>INSERT</code>、<code>UPDATE</code>、<code>DELETE</code>事件。所谓事件就是指<strong>用户的动作或者触发某项行为</strong>。如果定义了触发程序，当数据库执行这些语句时候，就相当于事件发生了，就会<strong>自动</strong>激发触发器执行相应的操作。</p><p>当对数据表中的数据执行插入、更新和删除操作，需要自动执行一些数据库逻辑时，可以使用触发器来实现。</p><h2 id="_2-触发器的创建" tabindex="-1"><a class="header-anchor" href="#_2-触发器的创建"><span>2. 触发器的创建</span></a></h2><h3 id="_2-1-创建触发器语法" tabindex="-1"><a class="header-anchor" href="#_2-1-创建触发器语法"><span>2.1 创建触发器语法</span></a></h3><p>创建触发器的语法结构是：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TRIGGER</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> 触发器名称</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEFORE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AFTER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">} {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INSERT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DELETE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 表名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FOR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> EACH </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ROW</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">触发器执行的语句块;</span></span></code></pre></div><p>说明：</p><ul><li><strong>表名</strong>：表示触发器监控的对象</li><li><code>BEFORE|AFTER</code>：表示触发的时间。<code>BEFORE</code> 表示在<strong>事件之前</strong>触发；<code>AFTER</code> 表示在<strong>事件之后</strong>触发</li><li><code>INSERT | UPDATE | DELETE</code>：表示触发的事件 <ul><li><code>INSERT</code> 表示插入记录时触发</li><li><code>UPDATE</code> 表示更新记录时触发</li><li><code>DELETE</code> 表示删除记录时触发</li></ul></li><li>触发器执行的语句块：可以是单条SQL语句，也可以是由<code>BEGIN...END</code>结构组成的复合语句块</li></ul><h3 id="_2-2-代码举例" tabindex="-1"><a class="header-anchor" href="#_2-2-代码举例"><span>2.2 代码举例</span></a></h3><p><strong>举例 1：</strong><br> 1 、创建数据表：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> test_trigger</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    t_note </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> test_trigger_log</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    t_log </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><p>2 、创建触发器：<br> 创建名称为<code>before_insert</code>的触发器，向<code>test_trigger</code>数据表插入数据之前，向<code>test_trigger_log</code>数据表中插入<code>before_insert</code>的日志信息。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TRIGGER</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> before_insert</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEFORE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> INSERT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> test_trigger</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FOR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> EACH </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ROW</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> test_trigger_log ( t_log )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">before_insert</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><p>3 、向<code>test_trigger</code>数据表中插入数据</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> test_trigger ( t_note )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">测试 BEFORE INSERT 触发器</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span></code></pre></div><p>4 、查看<code>test_trigger_log</code>数据表中的数据</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> test_trigger_log</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> t_log</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">         |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> before_insert</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p><strong>举例 2：</strong><br> 1 、创建名称为<code>after_insert</code>的触发器，向<code>test_trigger</code>数据表插入数据之后，向<code>test_trigger_log</code>数据表中插入<code>after_insert</code>的日志信息。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TRIGGER</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> after_insert</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AFTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> INSERT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> test_trigger</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FOR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> EACH </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ROW</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> test_trigger_log ( t_log )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">after_insert</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><p>2 、向<code>test_trigger</code>数据表中插入数据。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> test_trigger ( t_note )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">测试 AFTER INSERT 触发器</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span></code></pre></div><p>3 、查看<code>test_trigger_log</code>数据表中的数据</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> test_trigger_log</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> t_log</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">         |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> before_insert</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> before_insert</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> after_insert</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">3</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p><strong>举例 3 ：</strong><br> 定义触发器“<code>salary_check_trigger</code>”，基于员工表“<code>employees</code>”的<code>INSERT</code>事件，在<code>INSERT</code>之前检查将要添加的新员工薪资是否大于他领导的薪资，如果大于领导薪资，则报<code>sqlstate_value</code>为&#39;<code>HY000</code>&#39;的错误，从而使得添加失败。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">//</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TRIGGER</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> salary_check_trigger</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEFORE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> INSERT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> ON</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FOR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> EACH </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ROW</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> DECLARE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  mgrsalary DOUBLE;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  salary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> mgrsalary </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employees </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> NEW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">manager_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> IF</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  NEW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">salary</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> mgrsalary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">THEN</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   SIGNAL SQLSTATE </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">HY000</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">   SET</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> MESSAGE_TEXT </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">薪资高于领导薪资错误</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> END</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> IF</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">END</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> //</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">DELIMITER ;</span></span></code></pre></div><p>上面触发器声明过程中的<code>NEW</code>关键字代表<code>INSERT</code>添加语句的新记录</p><h2 id="_3-查看、删除触发器" tabindex="-1"><a class="header-anchor" href="#_3-查看、删除触发器"><span>3. 查看、删除触发器</span></a></h2><h3 id="_3-1-查看触发器" tabindex="-1"><a class="header-anchor" href="#_3-1-查看触发器"><span>3.1 查看触发器</span></a></h3><p>查看触发器是查看数据库中已经存在的触发器的定义、状态和语法信息等</p><p>方式 1 ：查看当前数据库的所有触发器的定义</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">SHOW TRIGGERS \G</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> TRIGGERS</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> \G</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 1. row </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Trigger:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> before_insert</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">               Event:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> INSERT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">               Table:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> test_trigger</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           Statement:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> BEGIN</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">INSERT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> INTO</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> test_trigger_log</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">t_log</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> )</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">before_insert</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> )</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">END</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">              Timing:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> BEFORE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Created:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 2025-09-06</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 22:19:56.33</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            sql_mode:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Definer:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> root@localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">character_set_client:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">collation_connection:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk_chinese_ci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  Database</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> Collation:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> utf8mb4_0900_ai_ci</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 2. row </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">***************************</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Trigger:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> after_insert</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">               Event:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> INSERT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">               Table:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> test_trigger</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           Statement:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> BEGIN</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">INSERT</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> INTO</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> test_trigger_log</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">t_log</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> )</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">after_insert</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> )</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">END</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">              Timing:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> AFTER</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Created:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 2025-09-06</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 22:21:38.81</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            sql_mode:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">             Definer:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> root@localhost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">character_set_client:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">collation_connection:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> gbk_chinese_ci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  Database</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> Collation:</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> utf8mb4_0900_ai_ci</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.01 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>方式 2 ：查看当前数据库中某个触发器的定义</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> TRIGGER 触发器名</span></span></code></pre></div><p>方式 3 ：从系统库information_schema的TRIGGERS表中查询“salary_check_trigger”触发器的信息。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> information_schema</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">TRIGGERS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><h3 id="_3-2-删除触发器" tabindex="-1"><a class="header-anchor" href="#_3-2-删除触发器"><span>3.2 删除触发器</span></a></h3><p>触发器也是数据库对象，删除触发器也用DROP语句，语法格式如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TRIGGER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 触发器名称;</span></span></code></pre></div><h2 id="_4-触发器的优缺点" tabindex="-1"><a class="header-anchor" href="#_4-触发器的优缺点"><span>4. 触发器的优缺点</span></a></h2><h3 id="_4-1-优点" tabindex="-1"><a class="header-anchor" href="#_4-1-优点"><span>4.1 优点</span></a></h3><p><strong>1 、触发器可以确保数据的完整性:</strong></p><p>假设我们用<strong>进货单头表</strong>（<code>demo.importhead</code>）来保存进货单的总体信息，包括进货单编号、供货商编号、仓库编号、总计进货数量、总计进货金额和验收日期。<br><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1757169644120-3c0d86b1-6a4b-4d43-bb77-fde70d415ffa.png" alt=""></p><p>用<strong>进货单明细表</strong>（<code>demo.importdetails</code>）来保存进货商品的明细，包括进货单编号、商品编号、进货数量、进货价格和进货金额。<br><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1757169644204-273ce257-1cf7-48e0-9550-363f453f7d77.png" alt=""></p><p>每当我们录入、删除和修改一条进货单明细数据的时候，进货单明细表里的数据就会发生变动。这个时候，在进货单头表中的总计数量和总计金额就必须重新计算，否则，进货单头表中的总计数量和总计金额就不等于进货单明细表中数量合计和金额合计了，这就是数据不一致</p><p>为了解决这个问题，我们就可以使用触发器， <strong>规定每当进货单明细表有数据插入、修改和删除的操作时，自动触发 2 步操作：</strong></p><p>1 ）重新计算进货单明细表中的数量合计和金额合计<br> 2 ）用第一步中计算出来的值更新进货单头表中的合计数量与合计金额</p><p>这样一来，进货单头表中的合计数量与合计金额的值，就始终与进货单明细表中计算出来的合计数量与合计金额的值相同，数据就是一致的，不会互相矛盾</p><p><strong>2 、触发器可以帮助我们记录操作日志:</strong></p><p>利用触发器，可以具体记录什么时间发生了什么。比如，记录修改会员储值金额的触发器，就是一个很好的例子。这对我们还原操作执行时的具体场景，更好地定位问题原因很有帮助</p><p><strong>3 、触发器还可以用在操作数据前，对数据进行合法性检查:</strong></p><p>比如，超市进货的时候，需要库管录入进货价格。但是，人为操作很容易犯错误，比如说在录入数量的时候，把条形码扫进去了；录入金额的时候，看串了行，录入的价格远超售价，导致账面上的巨亏这些都可以通过触发器，在实际插入或者更新操作之前，对相应的数据进行检查，及时提示错误，防止错误数据进入系统</p><h3 id="_4-2-缺点" tabindex="-1"><a class="header-anchor" href="#_4-2-缺点"><span>4.2 缺点</span></a></h3><p><strong>1 、触发器最大的一个问题就是可读性差:</strong></p><p>因为触发器存储在数据库中，并且由事件驱动，这就意味着<strong>触发器有可能不受应用层的控制</strong>。这对系统维护是非常有挑战的</p><p>比如，创建触发器用于修改会员储值操作。如果触发器中的操作出了问题，会导致会员储值金额更新失败。我用下面的代码演示一下：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">update</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> demo.membermaster</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> memberdeposit=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> where</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> memberid</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">ERROR</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1054</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (42S22): Unknown column </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">aa</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> in </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">field list</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span></span></code></pre></div><p>结果显示，系统提示错误，字段“aa”不存在。</p><p>这是因为，触发器中的数据插入操作多了一个字段，系统提示错误。可是，如果你不了解这个触发器，很可能会认为是更新语句本身的问题，或者是会员信息表的结构出了问题。说不定你还会给会员信息表添加一个叫“aa”的字段，试图解决这个问题，结果只能是白费力。</p><p><strong>2 、相关数据的变更，可能会导致触发器出错:</strong></p><p>特别是数据表结构的变更，都可能会导致触发器出错，进而影响数据操作的正常运行。这些都会由于触发器本身的隐蔽性，影响到应用中错误原因排查的效率。</p><h3 id="_4-3-注意点" tabindex="-1"><a class="header-anchor" href="#_4-3-注意点"><span>4.3 注意点</span></a></h3><p>注意，如果在子表中定义了外键约束，并且外键指定了<code>ON UPDATE/DELETE CASCADE/SET NULL</code>子句，此时修改父表被引用的键值或删除父表被引用的记录行时，也会引起子表的修改和删除操作，此时基于子表的<code>UPDATE</code>和<code>DELETE</code>语句定义的触发器并不会被激活</p><p>例如：基于子表员工表（<code>t_employee</code>）的<code>DELETE</code>语句定义了触发器<code>t1</code>，而子表的部门编号（<code>did</code>）字段定义了外键约束引用了父表部门表（<code>t_department</code>）的主键列部门编号（<code>did</code>），并且该外键加了“<code>ON DELETE SET NULL</code>”子句，那么如果此时删除父表部门表（<code>t_department</code>）在子表员工表（<code>t_employee</code>）有匹配记录的部门记录时，会引起子表员工表（<code>t_employee</code>）匹配记录的部门编号（<code>did</code>）修改为<code>NULL</code>，但是此时不会激活触发器<code>t1</code>。只有直接对子表员工表（<code>t_employee</code>）执行<code>DELETE</code>语句时才会激活触发器<code>t1</code>。</p></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-0d7da0a5 data-v-83bdd30b><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-83bdd30b><span class="contributors-label" data-v-83bdd30b>贡献者: </span><span class="contributors-info" data-v-83bdd30b><!--[--><!--[--><span class="contributor" data-v-83bdd30b>weew12</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-83bdd30b><div class="pager" data-v-83bdd30b><a class="vp-link link pager-link prev" href="/mysql/wa8pqbfi/" data-v-83bdd30b><!--[--><span class="desc" data-v-83bdd30b>上一页</span><span class="title" data-v-83bdd30b>第16章_变量、流程控制与游标</span><!--]--><!----></a></div><div class="pager" data-v-83bdd30b><a class="vp-link link pager-link next" href="/mysql/kprca6qs/" data-v-83bdd30b><!--[--><span class="desc" data-v-83bdd30b>下一页</span><span class="title" data-v-83bdd30b>第18章_MySQL8其它新特性</span><!--]--><!----></a></div></nav></footer><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;" data-v-0d7da0a5><div style="display: flex;align-items: center;justify-content: center;height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);--icon-size: 48px;display: inline-block;width: var(--icon-size);height: var(--icon-size);background-color: currentcolor;-webkit-mask-image: var(--loading-icon);mask-image: var(--loading-icon)"></span></div></div><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-27c095d7 data-v-7a5f51ab><span class="percent" data-allow-mismatch data-v-7a5f51ab>0%</span><span class="show icon vpi-back-to-top" data-v-7a5f51ab></span><svg aria-hidden="true" data-v-7a5f51ab><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-7a5f51ab></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-27c095d7 data-v-fe15003d><!--[--><div class="container" data-v-fe15003d><!----><p class="copyright" data-v-fe15003d>Copyright © 2026 weew12</p></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-BO2U5m27.js" defer></script></body></html>