<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.24" /><meta name="theme" content="VuePress Theme Plume " /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"第18章_MySQL8其它新特性","image":["https://cdn.nlark.com/yuque/0/2025/png/2447732/1757239707966-aaff90af-7ce4-4811-9fb0-b7f86f1c2f98.png","https://cdn.nlark.com/yuque/0/2025/png/2447732/1757239708032-acd355c3-cd0f-4172-b1c3-b47835fa231c.png"],"dateModified":"2025-09-07T10:12:08.000Z","author":[]}</script><meta property="og:url" content="https://weew12.github.io/mysql/kprca6qs/"><meta property="og:site_name" content="WEEW12 BLOG"><meta property="og:title" content="第18章_MySQL8其它新特性"><meta property="og:description" content="1. MySQL 8 新特性概述 MySQL从5.7版本直接跳跃发布了8.0版本，可见这是一个令人兴奋的里程碑版本。MySQL 8版本在功能上做了显著的改进与增强，开发者对MySQL的源代码进行了重构，最突出的一点是对MySQL Optimizer优化器进行了改进。不仅在速度上得到了改善，还为用户带来了更好的性能和更棒的体验 1.1 MySQL 8.0..."><meta property="og:type" content="article"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/png/2447732/1757239707966-aaff90af-7ce4-4811-9fb0-b7f86f1c2f98.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-09-07T10:12:08.000Z"><meta property="article:modified_time" content="2025-09-07T10:12:08.000Z"><link rel="icon" type="image/png" href="/favicon.ico"><meta name="referrer" content="no-referrer"><title>第18章_MySQL8其它新特性 | WEEW12 BLOG</title><meta name="description" content="1. MySQL 8 新特性概述 MySQL从5.7版本直接跳跃发布了8.0版本，可见这是一个令人兴奋的里程碑版本。MySQL 8版本在功能上做了显著的改进与增强，开发者对MySQL的源代码进行了重构，最突出的一点是对MySQL Optimizer优化器进行了改进。不仅在速度上得到了改善，还为用户带来了更好的性能和更棒的体验 1.1 MySQL 8.0..."><link rel="preload" href="/assets/style-VKnRds0j.css" as="style"><link rel="stylesheet" href="/assets/style-VKnRds0j.css"><link rel="modulepreload" href="/assets/app-BO2U5m27.js"><link rel="modulepreload" href="/assets/index.html-CKIS5mms.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-27c095d7><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-f5342612></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-f5342612> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-27c095d7 data-v-ae750b7e><div class="vp-navbar" vp-navbar data-v-ae750b7e data-v-3002d082><div class="wrapper" data-v-3002d082><div class="container" data-v-3002d082><div class="title" data-v-3002d082><div class="vp-navbar-title has-sidebar" data-v-3002d082 data-v-666dade2><a class="vp-link link no-icon title" href="/" data-v-666dade2><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="/logo.png" alt data-v-bc1f2c6d><!--]--><!--[--><img class="vp-image light logo" style="" src="/logo.png" alt data-v-bc1f2c6d><!--]--><!--]--><!--]--><span data-v-666dade2>WEEW12 BLOG</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-3002d082><div class="content-body" data-v-3002d082><!--[--><!--]--><div class="vp-navbar-search search" data-v-3002d082><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-3002d082 data-v-de5fb40d><span id="main-nav-aria-label" class="visually-hidden" data-v-de5fb40d>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>博客</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/tags/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>标签</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/categories/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>分类</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/archives/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>归档</span><!----><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-de5fb40d data-v-4393febb><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-4393febb><span class="text" data-v-4393febb><!----><!----><span data-v-4393febb>笔记</span><!----><span class="vpi-chevron-down text-icon" data-v-4393febb></span></span></button><div class="menu" data-v-4393febb><div class="vp-menu" data-v-4393febb data-v-471c6636><div class="items" data-v-471c6636><!--[--><!--[--><div class="vp-menu-group" data-v-471c6636 data-v-1ee9ef5f><p class="title" data-v-1ee9ef5f><!----><span data-v-1ee9ef5f>后端</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-1ee9ef5f data-v-04daa31f><a class="vp-link link" href="/language/java/1pj4wq5u/" data-v-04daa31f><!--[--><!----> 语言基础 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-1ee9ef5f data-v-04daa31f><a class="vp-link link" href="/framework/heima_ssm_book/r3rcs5o0/" data-v-04daa31f><!--[--><!----> 框架相关 <span class="vp-badge tip vp-menu-badge" style="" data-v-04daa31f data-v-26900783><!--[-->new<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="vp-menu-group" data-v-471c6636 data-v-1ee9ef5f><p class="title" data-v-1ee9ef5f><!----><span data-v-1ee9ef5f>数据库</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-1ee9ef5f data-v-04daa31f><a class="vp-link link" href="/mysql/q449w0j5/" data-v-04daa31f><!--[--><!----> MYSQL <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-3002d082 data-v-07ea9724><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-07ea9724 data-v-4b98d79f data-v-51d980cd><span class="check" data-v-51d980cd><span class="icon" data-v-51d980cd><!--[--><span class="vpi-sun sun" data-v-4b98d79f></span><span class="vpi-moon moon" data-v-4b98d79f></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-3002d082 data-v-99a107d5 data-v-3ad50ecc><!--[--><a class="vp-social-link no-icon" href="https://github.com/weew12" aria-label="github" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-github" /></a><a class="vp-social-link no-icon" href="mailto:2528566339@qq.com" aria-label="qq" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-qq" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-3002d082 data-v-d8b05a8e data-v-4393febb><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-4393febb><span class="vpi-more-horizontal icon" data-v-4393febb></span></button><div class="menu" data-v-4393febb><div class="vp-menu" data-v-4393febb data-v-471c6636><!----><!--[--><!--[--><!----><div class="group" data-v-d8b05a8e><div class="item appearance" data-v-d8b05a8e><p class="label" data-v-d8b05a8e>外观</p><div class="appearance-action" data-v-d8b05a8e><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-d8b05a8e data-v-4b98d79f data-v-51d980cd><span class="check" data-v-51d980cd><span class="icon" data-v-51d980cd><!--[--><span class="vpi-sun sun" data-v-4b98d79f></span><span class="vpi-moon moon" data-v-4b98d79f></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d8b05a8e><div class="item social-links" data-v-d8b05a8e><div class="vp-social-links social-links-list" data-v-d8b05a8e data-v-3ad50ecc><!--[--><a class="vp-social-link no-icon" href="https://github.com/weew12" aria-label="github" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-github" /></a><a class="vp-social-link no-icon" href="mailto:2528566339@qq.com" aria-label="qq" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-qq" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-3002d082 data-v-e5558799><span class="container" data-v-e5558799><span class="top" data-v-e5558799></span><span class="middle" data-v-e5558799></span><span class="bottom" data-v-e5558799></span></span></button></div></div></div></div><div class="divider" data-v-3002d082><div class="divider-line" data-v-3002d082></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-27c095d7 data-v-b0433a68><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-b0433a68><span class="vpi-align-left menu-icon" data-v-b0433a68></span><span class="menu-text" data-v-b0433a68>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-b0433a68 data-v-358fac30><button data-v-358fac30>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-27c095d7 data-v-fd62cea1><div class="curtain" data-v-fd62cea1></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-fd62cea1><span id="sidebar-aria-label" class="visually-hidden" data-v-fd62cea1> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-e274f709><section class="vp-sidebar-item sidebar-item level-0 collapsible has-active" data-v-e274f709 data-v-994e26d4><div class="item" role="button" tabindex="0" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><h2 class="text" data-v-994e26d4><span data-v-994e26d4>MYSQL</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-994e26d4><span class="vpi-chevron-right caret-icon" data-v-994e26d4></span></div></div><div data-v-994e26d4 data-v-994e26d4><div class="items" data-v-994e26d4><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/q449w0j5/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第00章_写在前面</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/o4l8p4jd/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第01章_数据库概述</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/o5yp3vh2/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第02章_MySQL环境搭建</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/p5uvykat/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第03章_基本的SELECT语句</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/qxt7xq29/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第04章_运算符</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/wmtsc974/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第05章_排序与分页</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/aolb36wf/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第06章_多表查询</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/c0jgzz2u/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第07章_单行函数</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/9an63vlq/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第08章_聚合函数</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/4fsjd16k/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第09章_子查询</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/5fre8wx1/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第10章_创建和管理表</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/aodt7kij/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第11章_数据处理之增删改</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/feuhpohs/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第12章_MySQL数据类型精讲</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/utbdi7eh/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第13章_约束</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/t5z4fo16/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第14章_视图</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/y0hix5xq/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第15章_存储过程与函数</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/wa8pqbfi/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第16章_变量、流程控制与游标</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/srx7ys3m/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第17章_触发器</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/kprca6qs/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第18章_MySQL8其它新特性</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-27c095d7 data-v-5b39a01b><div class="vp-doc-container has-sidebar has-aside" data-v-5b39a01b data-v-0d7da0a5><!--[--><!--]--><div class="container" data-v-0d7da0a5><div class="aside" vp-outline data-v-0d7da0a5><div class="aside-curtain" data-v-0d7da0a5></div><div class="aside-container" data-v-0d7da0a5><div class="aside-content" data-v-0d7da0a5><div class="vp-doc-aside" data-v-0d7da0a5 data-v-6df97c7f><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-6df97c7f data-v-3003aeb2><div class="content" data-v-3003aeb2><div class="outline-marker" data-v-3003aeb2></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-3003aeb2><span data-v-3003aeb2>目录</span><span class="vpi-print icon" data-v-3003aeb2></span></div><ul class="root" data-v-3003aeb2 data-v-f4c16ca0><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6df97c7f></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-0d7da0a5><div class="content-container" data-v-0d7da0a5><!--[--><!--]--><main class="main" data-v-0d7da0a5><nav class="vp-breadcrumb" data-v-0d7da0a5 data-v-eeb0b690><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-eeb0b690><!--[--><li property="itemListElement" typeof="ListItem" data-v-eeb0b690><a class="vp-link link breadcrumb" href="/" property="item" typeof="WebPage" data-v-eeb0b690><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-eeb0b690></span><meta property="name" content="首页" data-v-eeb0b690><meta property="position" content="1" data-v-eeb0b690></li><li property="itemListElement" typeof="ListItem" data-v-eeb0b690><span class="vp-link breadcrumb" property="item" typeof="WebPage" data-v-eeb0b690><!--[-->MYSQL<!--]--><!----></span><span class="vpi-chevron-right" data-v-eeb0b690></span><meta property="name" content="MYSQL" data-v-eeb0b690><meta property="position" content="2" data-v-eeb0b690></li><li property="itemListElement" typeof="ListItem" data-v-eeb0b690><a class="vp-link link breadcrumb current" href="/mysql/kprca6qs/" property="item" typeof="WebPage" data-v-eeb0b690><!--[-->第18章_MySQL8其它新特性<!--]--><!----></a><!----><meta property="name" content="第18章_MySQL8其它新特性" data-v-eeb0b690><meta property="position" content="3" data-v-eeb0b690></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-e9ba3c81><!----> 第18章_MySQL8其它新特性 <!----></h1><div class="vp-doc-meta" data-v-e9ba3c81><!--[--><!--]--><p class="reading-time" data-v-e9ba3c81><span class="vpi-books icon" data-v-e9ba3c81></span><span data-v-e9ba3c81>约 10792 字</span><span data-v-e9ba3c81>大约 36 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-e9ba3c81><span class="vpi-clock icon" data-v-e9ba3c81></span><span data-v-e9ba3c81>2025-09-07</span></p></div><!--]--><!--[--><!--]--><div class="_mysql_kprca6qs_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-0d7da0a5><!--[--><!--]--><div data-v-0d7da0a5><h2 id="_1-mysql-8-新特性概述" tabindex="-1"><a class="header-anchor" href="#_1-mysql-8-新特性概述"><span>1. MySQL 8 新特性概述</span></a></h2><p><strong>MySQL从5.7版本直接跳跃发布了8.0版本</strong>，可见这是一个令人兴奋的里程碑版本。<code>MySQL 8</code>版本在功能上做了显著的改进与增强，开发者对MySQL的源代码进行了重构，最突出的一点是对<code>MySQL Optimizer</code>优化器进行了改进。不仅在速度上得到了改善，还为用户带来了更好的性能和更棒的体验</p><h3 id="_1-1-mysql-8-0-新增特性" tabindex="-1"><a class="header-anchor" href="#_1-1-mysql-8-0-新增特性"><span>1.1 MySQL 8.0 新增特性</span></a></h3><p>1 . <strong>更简便的NoSQL支持</strong> <code>NoSQL</code>泛指非关系型数据库和数据存储。随着互联网平台的规模飞速发展，传统的关系型数据库已经越来越不能满足需求。<strong>从5.6版本开始，MySQL就开始支持简单的</strong><code>NoSQL</code><strong>存储功能。MySQL 8对这一功能做了优化，以更灵活的方式实现</strong><code>NoSQL</code><strong>功能，不再依赖模式（</strong><code>schema</code><strong>）</strong></p><p>2 . <strong>更好的索引</strong> 在查询中，正确地使用索引可以提高查询的效率。MySQL 8中新增了<strong>隐藏索引</strong>和<strong>降序索引</strong>。隐藏索引可以用来测试去掉索引对查询性能的影响。在查询中混合存在多列索引时，使用降序索引可以提高查询的性能</p><p>3 . <strong>更完善的</strong><code>JSON</code><strong>支持</strong> MySQL从5.7开始<strong>支持原生</strong><code>JSON</code><strong>数据的存储</strong>，<code>MySQL 8</code>对这一功能做了优化，增加了聚合函数<code>JSON_ARRAYAGG()</code>和<code>JSON_OBJECTAGG()</code>，<strong>将参数聚合为</strong><code>JSON</code><strong>数组或对象</strong>，新增了行内操作符 <code>-&gt;&gt;</code>，是列路径运算符 <code>-&gt;</code>的增强，对<code>JSON</code>排序做了提升，并优化了<code>JSON</code>的更新操作</p><p>4 . <strong>安全和账户管理</strong> <code>MySQL 8</code>中新增了<code>caching_sha2_password</code> 授权插件、角色、密码历史记录和<code>FIPS</code>模式支持，这些特性提高了数据库的安全性和性能，使数据库管理员能够更灵活地进行账户管理工作</p><p>5 . <code>InnoDB</code><strong>的变化</strong> <code>InnoDB</code>是MySQL<strong>默认的存储引擎</strong>，是事务型数据库的首选引擎，支持事务安全表（<code>ACID</code>），支持<strong>行锁定</strong>和<strong>外键</strong>。在<code>MySQL 8</code> 版本中，<code>InnoDB</code>在<strong>自增</strong>、<strong>索引</strong>、<strong>加密</strong>、<strong>死锁</strong>、<strong>共享锁</strong>等方面做了大量的改进和优化，并且支持原子数据定义语言（<code>DDL</code>），提高了数据安全性，对事务提供更好的支持</p><p>6 . <strong>数据字典</strong> 在之前的MySQL版本中，字典数据都存储在元数据文件和非事务表中。<strong>从MySQL 8开始新增了事务数据字典</strong>，在这个字典里存储着数据库对象信息，这些数据字典存储在内部事务表中</p><p>7 . <strong>原子数据定义语句</strong> MySQL 8开始支持<strong>原子数据定义语句</strong>（<code>Automic DDL</code>），即原子<code>DDL</code>。目前，只有<code>InnoDB</code>存储引擎支持原子<code>DDL</code>。原子数据定义语句（<code>DDL</code>）将与<code>DDL</code>操作相关的数据字典更新、存储引擎操作、二进制日志写入结合到一个单独的原子事务中，这<strong>使得即使服务器崩溃，事务也会提交或回滚使用支持原子操作的存储引擎所创建的表</strong>，在执行<code>DROP TABLE</code>、<code>CREATE TABLE</code>、<code>ALTER TABLE</code>、<code>RENAME TABLE</code>、<code>TRUNCATE TABLE</code>、<code>CREATE TABLESPACE</code>、<code>DROP TABLESPACE</code>等操作时，都支持原子操作，即<strong>事务要么完全操作成功，要么失败后回滚，不再进行部分提交</strong>。 对于从<code>MySQL 5.7</code>复制到<code>MySQL 8</code>版本中的语句，可以添加<code>IF EXISTS</code>或<code>IF NOT EXISTS</code>语句来避免发生错误</p><p>8 . <strong>资源管理</strong> <strong>MySQL 8开始支持创建和管理资源组，允许将服务器内运行的线程分配给特定的分组，以便线程根据组内可用资源执行</strong>。组属性能够控制组内资源，启用或限制组内资源消耗。数据库管理员能够根据不同的工作负载适当地更改这些属性。 目前，<code>CPU</code>时间是可控资源，由“<strong>虚拟</strong><code>CPU</code>”这个概念来表示，此术语包含<code>CPU</code>的核心数，超线程，硬件线程等等。服务器在启动时确定可用的虚拟<code>CPU</code>数量。拥有对应权限的数据库管理员可以将这些<code>CPU</code>与资源组关联，并为资源组分配线程。 资源组组件为MySQL中的资源组管理提供了<code>SQL</code>接口。资源组的属性用于定义资源组。<strong>MySQL中存在两个默认组，系统组和用户组，默认的组不能被删除，其属性也不能被更改。对于用户自定义的组，资源组创建时可初始化所有的属性，除去名字和类型，其他属性都可在创建之后进行更改</strong>。 在一些平台下，或进行了某些MySQL的配置时，资源管理的功能将受到限制，甚至不可用。例如，如果安装了线程池插件，或者使用的是<code>macOS</code>系统，资源管理将处于不可用状态。在<code>FreeBSD</code>和<code>Solaris</code>系统中，资源线程优先级将失效。在Linux系统中，只有配置了<code>CAP_SYS_NICE</code>属性，资源管理优先级才能发挥作用</p><p>9 . <strong>字符集支持</strong> <code>MySQL 8</code>中默认的字符集由<code>latin1</code>更改为<code>utf8mb4</code>，并首次增加了日语所特定使用的集合，<code>utf8mb4_ja_0900_as_cs</code></p><p>10 . <strong>优化器增强</strong> MySQL优化器开始支持<strong>隐藏索引</strong>和<strong>降序索引</strong>。<strong>隐藏索引</strong>不会被优化器使用，验证索引的必要性时不需要删除索引，先将索引隐藏，如果优化器性能无影响就可以真正地删除索引。<strong>降序索引</strong>允许优化器对多个列进行排序，并且允许排序顺序不一致</p><p>11 . <strong>公用表表达式</strong> 公用表表达式（<code>Common Table Expressions</code>）简称为<code>CTE</code>，MySQL现在支持<strong>递归</strong>和<strong>非递归</strong>两种形式的<code>CTE</code>。<code>CTE</code>通过在<code>SELECT</code>语句或其他特定语句前<strong>使用</strong><code>WITH</code><strong>语句对临时结果集进行命名</strong>，基础语法如下：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WITH</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> cte_name (col_name1, col_name2...) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (Subquery)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">    *</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    cte_name;</span></span></code></pre></div><p><code>Subquery</code>代表子查询，子查询前使用<code>WITH</code>语句将结果集命名为<code>cte_name</code>，在后续的查询中即可使用<code>cte_name</code>进行查询</p><p>12 . <strong>窗口函数</strong> MySQL 8开始支持窗口函数。<strong>在之前的版本中已存在的大部分聚合函数在MySQL 8中也可以作为窗口函数来使用</strong><br><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1757239707966-aaff90af-7ce4-4811-9fb0-b7f86f1c2f98.png" alt=""></p><p>13 . <strong>正则表达式支持</strong> MySQL在<code>8.0.4</code>以后的版本中采用支持<code>Unicode</code>的国际化组件库实现正则表达式操作，这种方式不仅能提供完全的<code>Unicode</code>支持，而且是<strong>多字节安全编码</strong>。MySQL增加了<code>REGEXP_LIKE()</code>、<code>EGEXP_INSTR()</code>、<code>EGEXP_REPLACE()</code>和 <code>REGEXP_SUBSTR()</code>等函数来提升性能。另外，<code>regexp_stack_limit</code>和<code>regexp_time_limit</code> 系统变量能够通过匹配引擎来控制资源消耗</p><p>14 . <strong>内部临时表</strong> <code>TempTable</code><strong>存储引擎取代</strong><code>MEMORY</code><strong>存储引擎成为内部临时表的默认存储引擎</strong>。<code>TempTable</code>存储引擎为<code>VARCHAR</code>和<code>VARBINARY</code>列提供高效存储。<code>internal_tmp_mem_storage_engine</code>会话变量定义了内部临时表的存储引擎，可选的值有两个，<code>TempTable</code>和<code>MEMORY</code>，其中<code>TempTable</code>为默认的存储引擎。<code>temptable_max_ram</code>系统配置项定义了<code>TempTable</code>存储引擎可使用的最大内存数量</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> VARIABLES</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">internal_tmp_mem_storage_engine</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------------------------+-----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Variable_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">                   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Value</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------------------------+-----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> internal_tmp_mem_storage_engine</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> TempTable</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------------------------+-----------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> warning</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SHOW</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> VARIABLES</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">temptable_max_ram</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Variable_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Value</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> temptable_max_ram</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1073741824</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------------+------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> warning</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">select</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> version</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 8.0.31</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">    |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-----------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>15 . <strong>日志记录</strong> 在MySQL 8中错误日志子系统由一系列MySQL组件构成。这些组件的构成由系统变量<code>log_error_services</code>来配置，能够实现日志事件的过滤和写入</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">show</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> variables</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> like</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">log_error_services</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+--------------------+----------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Variable_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Value</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">                                  |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+--------------------+----------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> log_error_services</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> log_filter_internal</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> log_sink_internal</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+--------------------+----------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set,</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> warning</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>16 . <strong>备份锁</strong> <strong>新的备份锁允许在线备份期间执行数据操作语句，同时阻止可能造成快照不一致的操作</strong>。新备份锁由 <code>LOCK INSTANCE FOR BACKUP</code> 和 <code>UNLOCK INSTANCE</code> 语法提供支持，执行这些操作需要备份管理员特权</p><p>17 . <strong>增强的MySQL复制</strong> MySQL 8复制支持对 <code>JSON</code><strong>文档</strong> 进行部分更新的<strong>二进制日志记录</strong>，该记录使用<strong>紧凑的二进制格式</strong>，从而节省记录完整<code>JSON</code>文档的空间。当使用基于语句的日志记录时，这种紧凑的日志记录会自动完成，并且可以通过将新的<code>binlog_row_value_options</code>系统变量值设置为<code>PARTIAL_JSON</code>来启用</p><h3 id="_1-2-mysql-8-0-移除的旧特性" tabindex="-1"><a class="header-anchor" href="#_1-2-mysql-8-0-移除的旧特性"><span>1.2 MySQL 8.0 移除的旧特性</span></a></h3><p>在MySQL 5.7版本上开发的应用程序如果使用了<code>MySQL8.0</code> 移除的特性，语句可能会失败，或者产生不同的执行结果。为了避免这些问题，对于使用了移除特性的应用，应当尽力修正避免使用这些特性，并尽可能使用替代方法</p><p>1 . <strong>查询缓存</strong> <strong>查询缓存已被移除</strong>，删除的项有：</p><ul><li><strong>语句</strong>： <code>FLUSH QUERY CACHE</code>和<code>RESET QUERY CACHE</code>。</li><li><strong>系统变量</strong>： <code>query_cache_limit</code>、<code>query_cache_min_res_unit</code>、<code>query_cache_size</code>、<code>query_cache_type</code>、<code>query_cache_wlock_invalidate</code>。</li><li><strong>状态变量</strong>： <code>Qcache_free_blocks</code>、<code>Qcache_free_memory</code>、<code>Qcache_hits</code>、<code>Qcache_inserts</code>、<code>Qcache_lowmem_prunes</code>、<code>Qcache_not_cached</code>、<code>Qcache_queries_in_cache</code>、<code>Qcache_total_blocks</code>。</li><li><strong>线程状态</strong>： <code>checking privileges on cached query</code>、<code>checking query cache for query</code>、<code>invalidating query cache entries</code>、<code>sending cached result to client</code>、<code>storing result in query cache</code>、<code>waiting for query cache lock</code></li></ul><p>2 . <strong>加密相关</strong> <strong>删除</strong>的加密相关的内容有：<code>ENCODE()</code>、<code>DECODE()</code>、<code>ENCRYPT()</code>、<code>DES_ENCRYPT()</code>和 <code>DES_DECRYPT()</code>函数，配置项<code>des-key-file</code>，系统变量<code>have_crypt</code>，<code>FLUSH</code>语句的<code>DES_KEY_FILE</code>选项, <code>HAVE_CRYPT</code> <code>CMake</code>选项。 对于移除的<code>ENCRYPT()</code>函数，考虑使用<code>SHA2()</code>替代，对于其他移除的函数，使用<code>AES_ENCRYPT()</code>和<code>AES_DECRYPT()</code>替代</p><p>3 . <strong>空间函数相关</strong> 在MySQL 5.7版本中，多个空间函数已被标记为过时。这些过时函数在MySQL 8中都已被移除，只保留了对应的<code>ST_</code>和<code>MBR</code>函数</p><p>4 . <code>\N</code><strong>和</strong><code>NULL</code> 在SQL语句中，<strong>解析器不再将</strong><code>\N</code><strong>视为</strong><code>NULL</code>，所以在SQL语句中应使用<code>NULL</code>代替<code>\N</code>。这项变化不会影响使用<code>LOAD DATA INFILE</code>或者<code>SELECT...INTO OUTFILE</code>操作文件的导入和导出。在这类操作中，<code>NULL</code>仍等同于<code>\N</code></p><p>5 . <code>mysql_install_db</code> 移除了<code>mysql_install_db</code>程序，数据字典初始化需要调用带着<code>--initialize</code>或者<code>--initialize-insecure</code>选项的<code>mysqld</code>来代替实现。另外，<code>--bootstrap</code>和<code>INSTALL_SCRIPTDIR CMake</code>也已被删除</p><p>6 . <strong>通用分区处理程序</strong> 通用分区处理程序已从MySQL服务中被移除。<strong>为了实现给定表分区，表所使用的存储引擎需要自有的分区处理程序。</strong> 提供本地分区支持的MySQL存储引擎有两个，即<code>InnoDB</code>和<code>NDB</code>，而在MySQL 8中只支持<code>InnoDB</code></p><p>7 . <strong>系统和状态变量信息</strong> 在<code>INFORMATION_SCHEMA</code>数据库中，对系统和状态变量信息不再进行维护<code>GLOBAL_VARIABLES</code>、<code>SESSION_VARIABLES</code>、<code>GLOBAL_STATUS</code>、<code>SESSION_STATUS</code>表都已被删除。另外，系统变量<code>show_compatibility_56</code>也已被删除。被删除的状态变量有<code>Slave_heartbeat_period</code>、<code>Slave_last_heartbeat</code>、<code>Slave_received_heartbeats</code>、<code>Slave_retried_transactions</code>、<code>Slave_running</code>。以上被删除的内容都可使用性能模式中对应的内容进行替代</p><p>补充：<br> 从 <strong>MySQL 8.0</strong> 开始，<code>INFORMATION_SCHEMA</code> 数据库中的 <code>GLOBAL_VARIABLES</code>、<code>SESSION_VARIABLES</code>、<code>GLOBAL_STATUS</code> 和 <code>SESSION_STATUS</code> 表<strong>已被移除</strong>。这些表和相关的 <code>show_compatibility_56</code> 系统变量都已被删除。这些系统变量和状态变量的信息，现在主要通过 <strong>Performance Schema</strong> 来提供和查询。</p><table><thead><tr><th>特性</th><th>MySQL 5.6 及更早版本</th><th>MySQL 5.7 (过渡期)</th><th><strong>MySQL 8.0 (当前)</strong></th></tr></thead><tbody><tr><td><strong>主要查询方式</strong></td><td><code>INFORMATION_SCHEMA</code> 表</td><td><code>INFORMATION_SCHEMA</code> 表 (已弃用) 或 <code>Performance Schema</code> 表</td><td><strong>Performance Schema 表</strong></td></tr><tr><td><strong><code>SHOW</code> 命令源</strong></td><td><code>INFORMATION_SCHEMA</code> 表</td><td>依赖 <code>show_compatibility_56</code> 设置</td><td><strong>Performance Schema 表</strong></td></tr><tr><td><strong><code>INFORMATION_SCHEMA</code> 中的变量表</strong></td><td>存在且常用</td><td>存在但已弃用</td><td><strong>已删除</strong></td></tr><tr><td><strong><code>show_compatibility_56</code> 变量</strong></td><td>不存在</td><td>存在，用于控制 <code>SHOW</code> 命令行为</td><td><strong>已删除</strong></td></tr><tr><td><strong>推荐查询方式</strong></td><td><code>SELECT * FROM INFORMATION_SCHEMA.GLOBAL_VARIABLES;</code></td><td><code>SELECT * FROM performance_schema.global_variables;</code> (5.7.6+)</td><td><strong><code>SELECT * FROM performance_schema.global_variables;</code></strong></td></tr></tbody></table><p>如何在 MySQL 8.0 中查询变量和状态信息<br> 在 MySQL 8.0 中，你应该使用 Performance Schema 中的以下系统表和状态表来获取相应的信息：</p><table><thead><tr><th>原 INFORMATION_SCHEMA 表</th><th>MySQL 8.0 替代方案 (Performance Schema)</th></tr></thead><tbody><tr><td><code>GLOBAL_VARIABLES</code></td><td><code>performance_schema.global_variables</code></td></tr><tr><td><code>SESSION_VARIABLES</code></td><td><code>performance_schema.session_variables</code></td></tr><tr><td><code>GLOBAL_STATUS</code></td><td><code>performance_schema.global_status</code></td></tr><tr><td><code>SESSION_STATUS</code></td><td><code>performance_schema.session_status</code></td></tr></tbody></table><p>8 . <code>mysql_plugin</code><strong>工具</strong> <code>mysql_plugin</code>工具用来配置MySQL服务器插件，现已被删除，可使用<code>--plugin-load</code>或<code>--plugin-load-add</code>选项在服务器启动时加载插件或者在运行时使用<code>INSTALL PLUGIN</code>语句加载插件来替代该工具</p><h2 id="_2-新特性1-窗口函数" tabindex="-1"><a class="header-anchor" href="#_2-新特性1-窗口函数"><span>2. 新特性1：窗口函数</span></a></h2><h3 id="_2-1-使用窗口函数前后对比" tabindex="-1"><a class="header-anchor" href="#_2-1-使用窗口函数前后对比"><span>2.1 使用窗口函数前后对比</span></a></h3><p>假设我现在有这样一个数据表，它显示了某购物网站在每个城市每个区的销售额：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> sales</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    city </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    county </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sales_value </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">DECIMAL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INSERT INTO</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sales(city, county, sales_value)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">北京</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">海淀</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">北京</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">朝阳</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">上海</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">黄埔</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    (</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">上海</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">长宁</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><p>查询：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> sales</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+------+--------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> city</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> county</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+------+--------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 北京</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 海淀</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 北京</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 朝阳</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          20</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 上海</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 黄埔</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 上海</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 长宁</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+------+--------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p><strong>需求</strong>： 现在计算这个网站在每个城市的销售总额、在全国的销售总额、每个区的销售额占所在城市销售额中的比率，以及占总销售额中的比率</p><p>如果用分组和聚合函数，就需要分好几步来计算：</p><p><strong>第一步</strong>，计算总销售金额，并存入临时表 <code>a</code>：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> TEMPORARY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> a </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 创建临时表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(sales_value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sales_value </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 计算总计金额</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sales;</span></span></code></pre></div><p>查看一下临时表 <code>a</code>：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p><strong>第二步</strong>，计算每个城市的销售总额并存入临时表 <code>b</code>：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> TEMPORARY </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> b </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 创建临时表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    city,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(sales_value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> sales_value </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 计算城市销售合计</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sales</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP BY</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    city;</span></span></code></pre></div><p>查看临时表 <code>b</code>：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> city</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 北京</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 上海</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">          40</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p><strong>第三步</strong>，计算各区的销售占所在城市的总计金额的比例，和占全部销售总计金额的比例。我们可以通过下面的连接查询获得需要的结果：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    s</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">city</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 城市,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    s</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">county</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 区,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    s</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 区销售额,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    b</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 市销售额,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    s</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 市比率,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    a</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 总销售额,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    s</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">sales_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 总比率</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sales s</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">city</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">city</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 连接市统计结果临时表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> a </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 连接总计金额临时表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    s</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">city</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">    s</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">county</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><p><strong>结果显示</strong>：市销售金额、市销售占比、总销售金额、总销售占比都计算出来了</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+------+----------+----------+--------+----------+--------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 城市</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 区</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 区销售额</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 市销售额</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 市比率</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 总销售额</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 总比率</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+------+----------+----------+--------+----------+--------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 上海</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 长宁</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       40</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.1429</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 上海</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 黄埔</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       40</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.7500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.4286</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 北京</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 朝阳</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       20</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.6667</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.2857</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 北京</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 海淀</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.3333</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.1429</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+------+----------+----------+--------+----------+--------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>同样的查询，如果用窗口函数，就简单多了。我们可以用下面的代码来实现：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    city </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 城市,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    county </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 区,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sales_value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 区销售额,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(sales_value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> city) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 市销售额,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">    -- 计算市销售额</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sales_value </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(sales_value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> city) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 市比率,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">    SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(sales_value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 总销售额,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">    -- 计算总销售额</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sales_value </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(sales_value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 总比率</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    sales</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    city,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    county;</span></span></code></pre></div><p>结果显示，我们得到了与上面那种查询同样的结果</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+------+----------+----------+--------+----------+--------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 城市</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 区</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 区销售额</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 市销售额</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 市比率</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 总销售额</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 总比率</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+------+----------+----------+--------+----------+--------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 上海</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 长宁</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       40</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.1429</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 上海</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 黄埔</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       40</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.7500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.4286</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 北京</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 朝阳</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       20</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.6667</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.2857</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 北京</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 海淀</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.3333</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.1429</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+------+------+----------+----------+--------+----------+--------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>使用窗口函数，只用了一步就完成了查询。而且，由于没有用到临时表，执行的效率也更高了。很显然， <strong>在这种需要用到分组统计的结果对每一条记录进行计算的场景下，使用窗口函数更好</strong></p><h3 id="_2-2-窗口函数分类" tabindex="-1"><a class="header-anchor" href="#_2-2-窗口函数分类"><span>2.2 窗口函数分类</span></a></h3><p><strong>MySQL从 8.0 版本开始支持窗口函数</strong>。窗口函数的作用类似于在查询中对数据进行分组，<strong>不同的是，分组操作会把分组的结果聚合成一条记录，而窗口函数是将结果置于每一条数据记录中</strong></p><p>补充：<br> 通俗地说，MySQL 8.0 的窗口函数就像给你的数据戴上了一副“分析眼镜”。它让你在<strong>不改变原始数据表格</strong>（每行数据都还在）的情况下，就能看到每一行数据在其所属小组中的“位置”和“上下文信息”。</p><p>为了更直观地理解窗口函数（<code>PARTITION BY</code>）和普通分组（<code>GROUP BY</code>）的核心区别，对比表格：</p><table><thead><tr><th>特性</th><th><code>GROUP BY</code> (普通分组)</th><th><code>PARTITION BY</code> (窗口函数)</th></tr></thead><tbody><tr><td><strong>结果行数</strong></td><td><strong>减少</strong>，每组只输出一行摘要</td><td><strong>不变</strong>，保留原表每一行数据</td></tr><tr><td><strong>输出内容</strong></td><td>只能显示分组字段和聚合结果</td><td>可以同时显示<strong>所有原始列</strong>和聚合结果</td></tr><tr><td><strong>好比</strong></td><td>公司财报：只告诉你每个部门的总工资</td><td>工资条：告诉你每个人的工资，<strong>以及</strong>他所在部门的平均工资</td></tr><tr><td><strong>常用场景</strong></td><td>获取汇总统计，如部门总人数、平均薪资</td><td>排名、累计计算、获取每行数据在组内的相对位置</td></tr></tbody></table><p>举个例子：看工资条</p><p>假设你有一张 <code>employees</code> 表：</p><table><thead><tr><th>emp_id</th><th>name</th><th>department</th><th>salary</th></tr></thead><tbody><tr><td>1</td><td>张三</td><td>销售</td><td>8000</td></tr><tr><td>2</td><td>李四</td><td>销售</td><td>7000</td></tr><tr><td>3</td><td>王五</td><td>技术</td><td>9000</td></tr></tbody></table><p>用 <code>GROUP BY</code> (普通分组)：你想知道每个部门的总工资。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department, </span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> total_salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department;</span></span></code></pre></div><p><strong>结果</strong>：表格被“折叠”了，每个部门只剩下一行总和。</p><table><thead><tr><th>department</th><th>total_salary</th></tr></thead><tbody><tr><td>销售</td><td>15000</td></tr><tr><td>技术</td><td>9000</td></tr></tbody></table><p>用窗口函数 <code>PARTITION BY</code>：你想看每个人的工资条，上面除了自己的工资，还要显示他所在部门的平均工资来做对比。</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> emp_id, </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> salary,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> avg_dept_salary</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees;</span></span></code></pre></div><p><strong>结果</strong>：所有人的详细信息都还在，但多了一列“部门平均工资”。</p><table><thead><tr><th>emp_id</th><th>name</th><th>department</th><th>salary</th><th><strong>avg_dept_salary</strong></th></tr></thead><tbody><tr><td>1</td><td>张三</td><td>销售</td><td>8000</td><td><strong>7500</strong></td></tr><tr><td>2</td><td>李四</td><td>销售</td><td>7000</td><td><strong>7500</strong></td></tr><tr><td>3</td><td>王五</td><td>技术</td><td>9000</td><td><strong>9000</strong></td></tr></tbody></table><p>这样一来，你不仅能知道张三赚8000，还能一眼看出他的工资比部门平均水平（7500）要高。这就是窗口函数的魔力——<strong>在保留所有细节的同时，为你提供额外的分析维度</strong>。</p><p>窗口函数可以分为<strong>静态窗口函数</strong>和<strong>动态窗口函数</strong></p><ul><li>静态窗口函数的<strong>窗口大小是固定的</strong>，不会因为记录的不同而不同</li><li>动态窗口函数的<strong>窗口大小会随着记录的不同而变化</strong></li></ul><p>MySQL官方网站窗口函数的网址为 <a href="https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html#function_row-number" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html#function_row-number</a></p><p>窗口函数总体上可以分为<strong>序号函数</strong>、<strong>分布函数</strong>、<strong>前后函数</strong>、<strong>首尾函数</strong>和<strong>其他函数</strong>，如下表：<br><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1757239708032-acd355c3-cd0f-4172-b1c3-b47835fa231c.png" alt=""></p><h3 id="_2-3-语法结构" tabindex="-1"><a class="header-anchor" href="#_2-3-语法结构"><span>2.3 语法结构</span></a></h3><p>窗口函数的语法结构是：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">函数 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">([PARTITION BY 字段名 ORDER BY 字段名 ASC|DESC])</span></span></code></pre></div><p>或者是:</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">函数 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 窗口名 ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WINDOW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 窗口名 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ([PARTITION BY 字段名 ORDER BY 字段名 ASC|DESC])</span></span></code></pre></div><ul><li><code>OVER</code> 关键字指定函数窗口的范围 <ul><li><strong>如果省略后面括号中的内容，则窗口会包含满足WHERE条件的所有记录</strong>，窗口函数会基于所有满足WHERE条件的记录进行计算</li><li>如果OVER关键字后面的括号不为空，则可以使用如下语法设置窗口</li></ul></li><li><strong>窗口名</strong>：为窗口设置一个别名，用来标识窗口</li><li><code>PARTITION BY</code><strong>子句</strong>：指定窗口函数按照哪些字段进行分组。分组后，窗口函数可以在每个分组中分别执行</li><li><code>ORDER BY</code><strong>子句</strong>：指定窗口函数按照哪些字段进行排序。执行排序操作使窗口函数按照排序后的数据记录的顺序进行编号</li><li><code>FRAME</code><strong>子句</strong>：为分区中的某个子集定义规则，可以用来作为滑动窗口使用</li></ul><h3 id="_2-4-分类讲解" tabindex="-1"><a class="header-anchor" href="#_2-4-分类讲解"><span>2.4 分类讲解</span></a></h3><p>创建表：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF;"> goods</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    category </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">    NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;"> VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">30</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    price </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">DECIMAL</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    stock </span><span style="--shiki-light:#D73A49;--shiki-dark:#C792EA;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">    upper_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DATETIME</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">);</span></span></code></pre></div><p>添加数据：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods ( category_id, category, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, price, stock, upper_time )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">VALUES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">女装/女士精品</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">T恤</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">39</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">女装/女士精品</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">连衣裙</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">79</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">女装/女士精品</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">卫衣</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">89</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">女装/女士精品</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">牛仔裤</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">89</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">3500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">女装/女士精品</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">百褶裙</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">29</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">女装/女士精品</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">呢绒外套</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">399</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">户外运动</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">自行车</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">399</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">户外运动</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">山地自行车</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1399</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">户外运动</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">登山杖</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">59</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">户外运动</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">骑行装备</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">399</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">3500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">户外运动</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">运动外套</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">799</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">户外运动</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">滑板</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">499</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">2020-11-10 00:00:00</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> );</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> goods</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    -</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">&gt; </span><span style="--shiki-light:#24292E;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+-------------+---------------+------------+---------+-------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> upper_time</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">          |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+-------------+---------------+------------+---------+-------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2020-11-10</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 00:00:00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+-------------+---------------+------------+---------+-------+---------------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>下面针对goods表中的数据来验证每个窗口函数的功能。</p><h4 id="_1-序号函数" tabindex="-1"><a class="header-anchor" href="#_1-序号函数"><span>1. 序号函数</span></a></h4><h5 id="row-number-函数" tabindex="-1"><a class="header-anchor" href="#row-number-函数"><span>ROW_NUMBER()函数</span></a></h5><p><code>ROW_NUMBER()</code>函数能够对数据中的<strong>序号</strong>进行顺序显示</p><p>举例：查询 <code>goods</code> 数据表中每个商品分类下<strong>价格降序</strong>排列的各个商品信息</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> ROW_NUMBER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> row_num,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> stock </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> row_num</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>举例：查询 <code>goods</code> 数据表中每个商品分类下<strong>价格最高的 <strong><code>3</code></strong> 种商品信息</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">  ROW_NUMBER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> row_num,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  category_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  stock </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  goods </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) t </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> row_num </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> row_num</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">6</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>在名称为“女装/女士精品”的商品类别中，有两款商品的价格为 <code>89.90</code> 元，分别是卫衣和牛仔裤。两款商品的序号都应该为 <code>2</code> ，而不是一个为 <code>2</code> ，另一个为 <code>3</code> 。此时，可以使用<code>RANK()</code>函数和<code>DENSE_RANK()</code>函数解决</p><h5 id="rank-函数" tabindex="-1"><a class="header-anchor" href="#rank-函数"><span>RANK()函数</span></a></h5><p>使用<code>RANK()</code>函数能够对序号进行<strong>并列排序</strong>，并且<strong>会跳过重复的序号</strong>，比如序号为 <code>1</code> 、 <code>1</code> 、 <code>3</code> （<code>2</code>号被跳过了）</p><p>举例：使用<code>RANK()</code>函数获取 <code>goods</code> 数据表中各类别的价格从高到低排序的各商品信息</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> row_num,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> stock </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> row_num</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>举例：使用<code>RANK()</code>函数获取 <code>goods</code> 数据表中类别为“女装/女士精品”的价格最高的 <code>4</code> 款商品信息</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">  RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> row_num,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  category_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  stock </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  goods </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) t </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> row_num </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+----------+--------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> row_num</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+----------+--------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+----------+--------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>可以看到，使用<code>RANK()</code>函数得出的序号为 <code>1</code> 、 <code>2</code> 、 <code>2</code> 、 <code>4</code> ，相同价格的商品序号相同，后面的商品序号是不连续的，跳过了重复的序号。</p><h5 id="dense-rank-函数" tabindex="-1"><a class="header-anchor" href="#dense-rank-函数"><span>DENSE_RANK()函数</span></a></h5><p><code>DENSE_RANK()</code>函数对序号进行<strong>并列排序</strong>，并且<strong>不会跳过重复的序号</strong>，比如序号为 <code>1</code> 、 <code>1</code> 、 <code>2</code></p><p>举例：使用<code>DENSE_RANK()</code>函数获取 <code>goods</code> 数据表中各类别的价格从高到低排序的各商品信息</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> DENSE_RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> row_num,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> stock </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> row_num</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+------------+---------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>举例：使用<code>DENSE_RANK()</code>函数获取 <code>goods</code> 数据表中类别为“女装/女士精品”的价格最高的 <code>4</code> 款商品信息</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">  DENSE_RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> row_num,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  category_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  stock </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  goods </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) t </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> row_num </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+----------+--------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> row_num</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+----------+--------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------+----+-------------+---------------+----------+--------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>可以看到，使用<code>DENSE_RANK()</code>函数得出的行号为 <code>1</code> 、 <code>2</code> 、 <code>2</code> 、 <code>3</code> ，相同价格的商品序号相同，后面的商品序号是连续的，并且没有跳过重复的序号</p><h4 id="_2-分布函数" tabindex="-1"><a class="header-anchor" href="#_2-分布函数"><span>2. 分布函数</span></a></h4><h5 id="percent-rank-函数" tabindex="-1"><a class="header-anchor" href="#percent-rank-函数"><span>PERCENT_RANK()函数</span></a></h5><p><code>PERCENT_RANK()</code>函数是<strong>等级值百分比函数</strong>。按照如下方式进行计算:</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(rank </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">rows</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> )</span></span></code></pre></div><p>其中，<code>rank</code>的值为使用<code>RANK()</code>函数产生的序号，<code>rows</code>的值为当前窗口的<strong>总记录数</strong></p><p>举例：计算 <code>goods</code> 数据表中名称为“女装/女士精品”的类别下的商品的<code>PERCENT_RANK</code>值</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">##写法一</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">     RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> r,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">     PERCENT_RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> pr,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     category_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">     NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     stock </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     goods </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#写法二：</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> r,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> PERCENT_RANK</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> pr,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> stock </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WINDOW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ); </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 定义了一个名为w的窗口</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---+-----+----+-------------+---------------+----------+--------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> r</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> pr</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---+-----+----+-------------+---------------+----------+--------+-------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   0</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---+-----+----+-------------+---------------+----------+--------+-------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">6</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 可以通过这个查询结果验证计算公式：</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (rank </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) / (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>这两种写法的区别和联系对比表格：</p><table><thead><tr><th>特性</th><th>写法1：内联窗口定义</th><th>写法2：命名窗口 (<code>WINDOW</code> 子句)</th></tr></thead><tbody><tr><td><strong>核心思想</strong></td><td>将窗口定义直接写在每个 <code>OVER()</code> 子句中</td><td>将窗口定义提取出来，命名后供多个 <code>OVER()</code> 子句复用</td></tr><tr><td><strong>代码长度</strong></td><td>较长，尤其是窗口定义复杂或被多次使用时</td><td><strong>更短，更简洁</strong>，避免了重复书写相同的窗口定义</td></tr><tr><td><strong>可读性</strong></td><td>当窗口定义重复时，可读性较差</td><td><strong>更清晰</strong>，窗口定义集中管理，逻辑更一目了然</td></tr><tr><td><strong>可维护性</strong></td><td>较低，修改窗口定义需逐个修改每个<code>OVER()</code>子句</td><td><strong>更高</strong>，只需修改一处定义即可全局生效</td></tr><tr><td><strong>适用场景</strong></td><td>查询中只使用一次该窗口定义时</td><td>查询中<strong>多次使用相同窗口定义</strong>时</td></tr></tbody></table><h5 id="cume-dist-函数" tabindex="-1"><a class="header-anchor" href="#cume-dist-函数"><span>CUME_DIST()函数</span></a></h5><p><code>CUME_DIST()</code>函数主要用于查询小于或等于某个值的比例（累计分布：<code>cumulative distribution</code>）</p><p>举例：查询<code>goods</code>数据表中小于或等于当前价格的比例</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">     CUME_DIST</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ASC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> cd,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">     NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     price </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     goods;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------------+----+---------------+------------+---------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> cd</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">                  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------------+----+---------------+------------+---------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.16666666666666666</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  0.3333333333333333</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                 0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  0.8333333333333334</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  0.8333333333333334</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                   1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 0.16666666666666666</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                 0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                 0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  0.6666666666666666</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  0.8333333333333334</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">                   1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------------+----+---------------+------------+---------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h4 id="_3-前后函数" tabindex="-1"><a class="header-anchor" href="#_3-前后函数"><span>3. 前后函数</span></a></h4><h5 id="lag-expr-n-函数" tabindex="-1"><a class="header-anchor" href="#lag-expr-n-函数"><span>LAG(expr,n)函数</span></a></h5><p><code>LAG(expr,n)</code>函数返回当前行的前<code>n</code>行的<code>expr</code>的值</p><p>举例：查询<code>goods</code>数据表中前一个商品价格与当前商品价格的差值</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> pre_price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> pre_price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> diff_price </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  price,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">  LAG</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( price, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> pre_price </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> WINDOW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price ) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) t;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+-----------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> pre_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> diff_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+-----------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      10.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      40.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      10.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       0.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     310.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     340.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       0.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     100.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     300.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     600.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+-----------+------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h5 id="lead-expr-n-函数" tabindex="-1"><a class="header-anchor" href="#lead-expr-n-函数"><span>LEAD(expr,n)函数</span></a></h5><p><code>LEAD(expr,n)</code>函数返回当前行的后<code>n</code>行的<code>expr</code>的值</p><p>举例：查询<code>goods</code>数据表中后一个商品价格与当前商品价格的差值</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> behind_price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> behind_price </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> diff_price </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  price,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">  LEAD</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( price, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> behind_price </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> WINDOW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price ) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) t;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+--------------+---------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> behind_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> diff_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+--------------+---------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      10.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      40.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      10.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       0.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     310.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     340.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       0.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     100.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     300.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     600.00</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+--------------+---------+------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h4 id="_4-首尾函数" tabindex="-1"><a class="header-anchor" href="#_4-首尾函数"><span>4. 首尾函数</span></a></h4><h5 id="first-value-expr-函数" tabindex="-1"><a class="header-anchor" href="#first-value-expr-函数"><span>FIRST_VALUE(expr)函数</span></a></h5><p><code>FIRST_VALUE(expr)</code>函数返回第一个<code>expr</code>的值</p><p>举例：按照价格排序，查询第 <code>1</code> 个商品的价格信息</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> stock,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> FIRST_VALUE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( price ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> first_price </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WINDOW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price );</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+-------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> first_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+-------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+-------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h5 id="last-value-expr-函数" tabindex="-1"><a class="header-anchor" href="#last-value-expr-函数"><span>LAST_VALUE(expr)函数</span></a></h5><p><code>LAST_VALUE(expr)</code>函数返回最后一个<code>expr</code>的值</p><p>举例：按照价格排序，查询最后一个商品的价格信息</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> stock,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> LAST_VALUE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( price ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> last_price </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WINDOW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price );</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+-------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> stock</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> last_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+-------+------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">     799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">    1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+-------+------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> 注意此处函数用法效果和FIRST_VALUE的区别</span></span></code></pre></div><h4 id="_5-其他函数" tabindex="-1"><a class="header-anchor" href="#_5-其他函数"><span>5. 其他函数</span></a></h4><h5 id="nth-value-expr-n-函数" tabindex="-1"><a class="header-anchor" href="#nth-value-expr-n-函数"><span>NTH_VALUE(expr,n)函数</span></a></h5><p><code>NTH_VALUE(expr,n)</code>函数返回第<code>n</code>个<code>expr</code>的值</p><p>举例：查询<code>goods</code>数据表中排名第 <code>2</code> 和第 <code>3</code> 的价格信息</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> NTH_VALUE( price, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> second_price,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> NTH_VALUE( price, </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> third_price </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WINDOW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price );</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+--------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> second_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> third_price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+--------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        NULL</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">       399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">      399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+---------------+------------+---------+--------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h5 id="ntile-n-函数" tabindex="-1"><a class="header-anchor" href="#ntile-n-函数"><span>NTILE(n)函数</span></a></h5><p><code>NTILE(n)</code>函数将分区中的有序数据分为<code>n</code>个桶，记录桶编号</p><p>举例：将<code>goods</code>表中的商品按照价格分为 <code>3</code> 组</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> NTILE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">( </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> nt,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> NAME</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> goods </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WINDOW</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> category_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> price );</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+----+---------------+------------+---------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> nt</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> price</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+----+---------------+------------+---------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  5</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 百褶裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   29.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> T恤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   39.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 连衣裙</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   79.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 卫衣</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  4</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 牛仔裤</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   89.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  6</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 女装/女士精品</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 呢绒外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  9</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 登山杖</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">   59.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  7</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 骑行装备</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  2</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 12</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 滑板</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  499.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 11</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 运动外套</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  799.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  3</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">  8</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 户外运动</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 山地自行车</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> 1399.90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+----+----+---------------+------------+---------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><h3 id="_2-5-小-结" tabindex="-1"><a class="header-anchor" href="#_2-5-小-结"><span>2.5 小 结</span></a></h3><p>窗口函数的特点是可以分组，而且可以在分组内排序。另外，窗口函数不会因为分组而减少原表中的行数，这对我们在原表数据的基础上进行统计和排序非常有用</p><h2 id="_3-新特性2-公用表表达式" tabindex="-1"><a class="header-anchor" href="#_3-新特性2-公用表表达式"><span>3. 新特性2：公用表表达式</span></a></h2><p>公用表表达式（或通用表表达式）简称为<code>CTE</code>（<code>Common Table Expressions</code>）。<code>CTE</code>是<strong>一个命名的临时结果集</strong>，<strong>作用范围是当前语句</strong>。<code>CTE</code>可以理解成一个可以复用的子查询，当然跟子查询还是有点区别的，<code>CTE</code><strong>可以引用其他</strong><code>CTE</code><strong>，但子查询不能引用其他子查询。</strong> 所以，可以考虑代替子查询。</p><p>依据语法结构和执行方式的不同，公用表表达式分为<strong>普通公用表表达式</strong>和<strong>递归公用表表达式</strong> <code>2</code> 种</p><h3 id="_3-1-普通公用表表达式" tabindex="-1"><a class="header-anchor" href="#_3-1-普通公用表表达式"><span>3.1 普通公用表表达式</span></a></h3><p>普通公用表表达式的语法结构是：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WITH</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> CTE名称</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> （子查询）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DELETE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 语句</span></span></code></pre></div><p>普通公用表表达式类似于子查询，不过，跟子查询不同的是，它可以被多次引用，而且可以被其他的普通公用表表达式所引用</p><p>举例：查询员工所在的部门的详细信息</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> departments </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees );</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------+------------------+------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> department_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> department_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> manager_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> location_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------+------------------+------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Administration</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            20</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Marketing</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        201</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1800</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Purchasing</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        114</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            40</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Human</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> Resources</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        203</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        2400</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            50</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Shipping</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">         |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        121</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            60</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> IT</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">               |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        103</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1400</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Public</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> Relations</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        204</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        2700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            80</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Sales</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">            |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        145</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Executive</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        100</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           100</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Finance</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">          |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        108</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           110</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Accounting</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        205</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------+------------------+------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">11</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>这个查询也可以用普通公用表表达式的方式完成：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WITH</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> emp_dept_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employees ) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> departments d</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> emp_dept_id e </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> d</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> e</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">department_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------+------------------+------------+-------------+---------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> department_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> department_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> manager_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> location_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> department_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------+------------------+------------+-------------+---------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Administration</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            10</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            20</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Marketing</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        201</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1800</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            20</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Purchasing</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        114</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            30</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            40</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Human</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> Resources</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        203</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        2400</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            40</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            50</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Shipping</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">         |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        121</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            50</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            60</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> IT</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">               |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        103</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1400</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            60</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Public</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> Relations</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        204</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        2700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            70</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            80</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Sales</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">            |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        145</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        2500</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            80</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Executive</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        100</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">            90</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           100</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Finance</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">          |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        108</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           100</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           110</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Accounting</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        205</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">        1700</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">           110</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+---------------+------------------+------------+-------------+---------------+</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">11</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (0.00 </span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">sec</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>例子说明，公用表表达式可以起到子查询的作用。以后如果遇到需要使用子查询的场景，你可以在查询之前，先定义公用表表达式，然后在查询中用它来代替子查询。而且，跟子查询相比，<strong>公用表表达式有一个优点，就是定义过公用表表达式之后的查询，可以像一个表一样多次引用公用表表达式，而子查询则不能</strong></p><h3 id="_3-2-递归公用表表达式" tabindex="-1"><a class="header-anchor" href="#_3-2-递归公用表表达式"><span>3.2 递归公用表表达式</span></a></h3><p>递归公用表表达式也是一种公用表表达式，只不过，除了普通公用表表达式的特点以外，它还有自己的特点，就是 <strong>可以调用自己</strong> 。它的语法结构是：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WITH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> RECURSIVE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">CTE名称 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> （子查询）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DELETE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 语句</span></span></code></pre></div><p>递归公用表表达式由 <code>2</code> 部分组成，分别是<strong>种子查询</strong>和<strong>递归查询</strong>，中间通过关键字 <code>UNION [ALL]</code>进行连接。这里的 <strong>种子查询，意思就是获得递归的初始值</strong> 。这个查询只会运行一次，以创建初始数据集，之后递归查询会一直执行，直到没有任何新的查询数据产生，递归返回</p><p>案例： 针对于我们常用的<code>employees</code>表，包含<code>employee_id</code>，<code>last_name</code>和<code>manager_id</code>三个字段。如果<code>a</code>是<code>b</code>的管理者，那么，我们可以把<code>b</code>叫做<code>a</code>的下属，如果同时<code>b</code>又是<code>c</code>的管理者，那么<code>c</code>就是<code>b</code>的下属，是<code>a</code>的下下属</p><p>下面我们尝试用查询语句列出所有具有下下属身份的人员信息</p><p>如果用我们之前学过的知识来解决，会比较复杂，至少要进行 <code>4</code> 次查询才能搞定：</p><ul><li>第一步，先找出初代管理者，就是不以任何别人为管理者的人，把结果存入临时表</li><li>第二步，找出所有以初代管理者为管理者的人，得到一个下属集，把结果存入临时表</li><li>第三步，找出所有以下属为管理者的人，得到一个下下属集，把结果存入临时表</li><li>第四步，找出所有以下下属为管理者的人，得到一个结果集</li></ul><p>如果第四步的结果集为空，则计算结束，第三步的结果集就是我们需要的下下属集了，否则就必须继续进行第四步，一直到结果集为空为止。比如上面的这个数据表，就需要到第五步，才能得到空结果集。而且，最后还要进行第六步：把第三步和第四步的结果集合并，这样才能最终获得我们需要的结果集。</p><p>如果用递归公用表表达式，就非常简单了。具体的思路:</p><ul><li>用递归公用表表达式中的<strong>种子查询</strong>，找出初代管理者。字段 <code>n</code> 表示代次，初始值为 <code>1</code> ，表示是第一代管理者。</li><li>用递归公用表表达式中的<strong>递归查询</strong>，查出以这个递归公用表表达式中的人为管理者的人，并且代次的值加 <code>1</code> 。直到没有人以这个递归公用表表达式中的人为管理者了，递归返回。</li><li>在最后的查询中，选出所有代次大于等于 <code>3</code> 的人，他们肯定是第三代及以上代次的下属了，也就是下下属了。这样就得到了我们需要的结果集。</li></ul><p>这里看似也是 <code>3</code> 步，实际上是一个查询的 <code>3</code> 个部分，只需要执行一次就可以了。而且也不需要用临时表保存中间结果，比刚刚的方法简单多了</p><p>代码实现：</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WITH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> RECURSIVE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> cte </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  last_name,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  manager_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">  1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> n </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employees </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employee_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 100</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;"> -- 种子查询，找到第一代领导</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> UNION ALL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  a</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">employee_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  a</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">last_name</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">  a</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">manager_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  n </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  employees </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> a</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">  JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> cte </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ( </span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">manager_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> cte</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">employee_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 递归查询，找出以递归公用表表达式的人为领导的人</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> employee_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> last_name </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> cte </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> n </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> employee_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> last_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">+-------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         108</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Greenberg</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">   |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         200</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Whalen</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         203</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Mavris</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         204</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Baer</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         205</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Higgins</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">     |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         103</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Hunold</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         115</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Khoo</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">        |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         116</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Baida</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         117</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Tobias</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         118</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Himuro</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         119</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Colmenares</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">  |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         125</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Nayer</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">       |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         126</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Mikkilineni</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;">         127</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#FFCB6B;"> Landry</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">      |</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">...</span></span></code></pre></div><p>总之，递归公用表表达式对于查询一个有共同的根节点的树形结构数据，非常有用。它可以不受层级的限制，轻松查出所有节点的数据。如果用其他的查询方式，就比较复杂了</p><h3 id="_3-3-小-结" tabindex="-1"><a class="header-anchor" href="#_3-3-小-结"><span>3.3 小 结</span></a></h3><p>公用表表达式的作用是可以替代子查询，而且可以被多次引用。递归公用表表达式对查询有一个共同根节点的树形结构数据非常高效，可以轻松搞定其他查询方式难以处理的查询</p></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-0d7da0a5 data-v-83bdd30b><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-83bdd30b><span class="contributors-label" data-v-83bdd30b>贡献者: </span><span class="contributors-info" data-v-83bdd30b><!--[--><!--[--><span class="contributor" data-v-83bdd30b>weew12</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-83bdd30b><div class="pager" data-v-83bdd30b><a class="vp-link link pager-link prev" href="/mysql/srx7ys3m/" data-v-83bdd30b><!--[--><span class="desc" data-v-83bdd30b>上一页</span><span class="title" data-v-83bdd30b>第17章_触发器</span><!--]--><!----></a></div><div class="pager" data-v-83bdd30b><!----></div></nav></footer><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;" data-v-0d7da0a5><div style="display: flex;align-items: center;justify-content: center;height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);--icon-size: 48px;display: inline-block;width: var(--icon-size);height: var(--icon-size);background-color: currentcolor;-webkit-mask-image: var(--loading-icon);mask-image: var(--loading-icon)"></span></div></div><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-27c095d7 data-v-7a5f51ab><span class="percent" data-allow-mismatch data-v-7a5f51ab>0%</span><span class="show icon vpi-back-to-top" data-v-7a5f51ab></span><svg aria-hidden="true" data-v-7a5f51ab><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-7a5f51ab></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-27c095d7 data-v-fe15003d><!--[--><div class="container" data-v-fe15003d><!----><p class="copyright" data-v-fe15003d>Copyright © 2026 weew12</p></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-BO2U5m27.js" defer></script></body></html>