<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.24" /><meta name="theme" content="VuePress Theme Plume " /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"第08章_聚合函数","image":["https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394412-fa2295a8-a4f9-4a19-bf63-acd4ae9d626e.png","https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394498-be4bb0b9-3c73-42c9-9426-e03710881b90.png","https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394571-73c0811b-a527-428e-9a62-0a54c46fba60.png","https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394676-434438b1-74f0-4b82-a4a2-db5c96821e12.png","https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394753-ddeef0ac-44f2-4e52-ac34-18c2cc56b32b.png","https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394824-324ebab8-3053-4009-be58-9678b5cd6387.png","https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394889-0eed19a9-fb59-4fca-b524-f087c9a5acd6.png","https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394957-e9446b44-547e-4fde-aa9f-6112ddc257be.png"],"dateModified":"2025-09-02T02:20:49.000Z","author":[]}</script><meta property="og:url" content="https://weew12.github.io/mysql/9an63vlq/"><meta property="og:site_name" content="WEEW12 BLOG"><meta property="og:title" content="第08章_聚合函数"><meta property="og:description" content="上一章讲到了 SQL 单行函数。实际上 SQL 函数还有一类，叫做聚合（或聚集、分组）函数，它是对一组数据进行汇总的函数，输入的是一组数据的集合，输出的是单个值。 1. 聚合函数介绍 什么是聚合函数 聚合函数作用于一组数据，并对一组数据返回一个值 聚合函数类型 AVG() SUM() MAX() MIN() COUNT() 聚合函数语法 聚合函数不能嵌..."><meta property="og:type" content="article"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394412-fa2295a8-a4f9-4a19-bf63-acd4ae9d626e.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-09-02T02:20:49.000Z"><meta property="article:modified_time" content="2025-09-02T02:20:49.000Z"><link rel="icon" type="image/png" href="/favicon.ico"><meta name="referrer" content="no-referrer"><title>第08章_聚合函数 | WEEW12 BLOG</title><meta name="description" content="上一章讲到了 SQL 单行函数。实际上 SQL 函数还有一类，叫做聚合（或聚集、分组）函数，它是对一组数据进行汇总的函数，输入的是一组数据的集合，输出的是单个值。 1. 聚合函数介绍 什么是聚合函数 聚合函数作用于一组数据，并对一组数据返回一个值 聚合函数类型 AVG() SUM() MAX() MIN() COUNT() 聚合函数语法 聚合函数不能嵌..."><link rel="preload" href="/assets/style-VKnRds0j.css" as="style"><link rel="stylesheet" href="/assets/style-VKnRds0j.css"><link rel="modulepreload" href="/assets/app-BO2U5m27.js"><link rel="modulepreload" href="/assets/index.html-wpWM6MPK.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-27c095d7><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-f5342612></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-f5342612> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-27c095d7 data-v-ae750b7e><div class="vp-navbar" vp-navbar data-v-ae750b7e data-v-3002d082><div class="wrapper" data-v-3002d082><div class="container" data-v-3002d082><div class="title" data-v-3002d082><div class="vp-navbar-title has-sidebar" data-v-3002d082 data-v-666dade2><a class="vp-link link no-icon title" href="/" data-v-666dade2><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="/logo.png" alt data-v-bc1f2c6d><!--]--><!--[--><img class="vp-image light logo" style="" src="/logo.png" alt data-v-bc1f2c6d><!--]--><!--]--><!--]--><span data-v-666dade2>WEEW12 BLOG</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-3002d082><div class="content-body" data-v-3002d082><!--[--><!--]--><div class="vp-navbar-search search" data-v-3002d082><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-3002d082 data-v-de5fb40d><span id="main-nav-aria-label" class="visually-hidden" data-v-de5fb40d>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>博客</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/tags/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>标签</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/categories/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>分类</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/archives/" tabindex="0" data-v-de5fb40d data-v-bc304da9><!--[--><!----><span data-v-bc304da9>归档</span><!----><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-de5fb40d data-v-4393febb><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-4393febb><span class="text" data-v-4393febb><!----><!----><span data-v-4393febb>笔记</span><!----><span class="vpi-chevron-down text-icon" data-v-4393febb></span></span></button><div class="menu" data-v-4393febb><div class="vp-menu" data-v-4393febb data-v-471c6636><div class="items" data-v-471c6636><!--[--><!--[--><div class="vp-menu-group" data-v-471c6636 data-v-1ee9ef5f><p class="title" data-v-1ee9ef5f><!----><span data-v-1ee9ef5f>后端</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-1ee9ef5f data-v-04daa31f><a class="vp-link link" href="/language/java/1pj4wq5u/" data-v-04daa31f><!--[--><!----> 语言基础 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-1ee9ef5f data-v-04daa31f><a class="vp-link link" href="/framework/heima_ssm_book/r3rcs5o0/" data-v-04daa31f><!--[--><!----> 框架相关 <span class="vp-badge tip vp-menu-badge" style="" data-v-04daa31f data-v-26900783><!--[-->new<!--]--></span><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="vp-menu-group" data-v-471c6636 data-v-1ee9ef5f><p class="title" data-v-1ee9ef5f><!----><span data-v-1ee9ef5f>数据库</span></p><!--[--><!--[--><div class="vp-menu-link" data-v-1ee9ef5f data-v-04daa31f><a class="vp-link link" href="/mysql/q449w0j5/" data-v-04daa31f><!--[--><!----> MYSQL <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-3002d082 data-v-07ea9724><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-07ea9724 data-v-4b98d79f data-v-51d980cd><span class="check" data-v-51d980cd><span class="icon" data-v-51d980cd><!--[--><span class="vpi-sun sun" data-v-4b98d79f></span><span class="vpi-moon moon" data-v-4b98d79f></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-3002d082 data-v-99a107d5 data-v-3ad50ecc><!--[--><a class="vp-social-link no-icon" href="https://github.com/weew12" aria-label="github" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-github" /></a><a class="vp-social-link no-icon" href="mailto:2528566339@qq.com" aria-label="qq" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-qq" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-3002d082 data-v-d8b05a8e data-v-4393febb><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-4393febb><span class="vpi-more-horizontal icon" data-v-4393febb></span></button><div class="menu" data-v-4393febb><div class="vp-menu" data-v-4393febb data-v-471c6636><!----><!--[--><!--[--><!----><div class="group" data-v-d8b05a8e><div class="item appearance" data-v-d8b05a8e><p class="label" data-v-d8b05a8e>外观</p><div class="appearance-action" data-v-d8b05a8e><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-d8b05a8e data-v-4b98d79f data-v-51d980cd><span class="check" data-v-51d980cd><span class="icon" data-v-51d980cd><!--[--><span class="vpi-sun sun" data-v-4b98d79f></span><span class="vpi-moon moon" data-v-4b98d79f></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d8b05a8e><div class="item social-links" data-v-d8b05a8e><div class="vp-social-links social-links-list" data-v-d8b05a8e data-v-3ad50ecc><!--[--><a class="vp-social-link no-icon" href="https://github.com/weew12" aria-label="github" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-github" /></a><a class="vp-social-link no-icon" href="mailto:2528566339@qq.com" aria-label="qq" target="_blank" rel="noopener" data-v-3ad50ecc data-v-959e34fc><span class="vpi-social-qq" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-3002d082 data-v-e5558799><span class="container" data-v-e5558799><span class="top" data-v-e5558799></span><span class="middle" data-v-e5558799></span><span class="bottom" data-v-e5558799></span></span></button></div></div></div></div><div class="divider" data-v-3002d082><div class="divider-line" data-v-3002d082></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-27c095d7 data-v-b0433a68><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-b0433a68><span class="vpi-align-left menu-icon" data-v-b0433a68></span><span class="menu-text" data-v-b0433a68>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-b0433a68 data-v-358fac30><button data-v-358fac30>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-27c095d7 data-v-fd62cea1><div class="curtain" data-v-fd62cea1></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-fd62cea1><span id="sidebar-aria-label" class="visually-hidden" data-v-fd62cea1> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-e274f709><section class="vp-sidebar-item sidebar-item level-0 collapsible has-active" data-v-e274f709 data-v-994e26d4><div class="item" role="button" tabindex="0" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><h2 class="text" data-v-994e26d4><span data-v-994e26d4>MYSQL</span><!----></h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-994e26d4><span class="vpi-chevron-right caret-icon" data-v-994e26d4></span></div></div><div data-v-994e26d4 data-v-994e26d4><div class="items" data-v-994e26d4><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/q449w0j5/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第00章_写在前面</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/o4l8p4jd/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第01章_数据库概述</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/o5yp3vh2/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第02章_MySQL环境搭建</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/p5uvykat/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第03章_基本的SELECT语句</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/qxt7xq29/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第04章_运算符</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/wmtsc974/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第05章_排序与分页</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/aolb36wf/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第06章_多表查询</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/c0jgzz2u/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第07章_单行函数</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/9an63vlq/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第08章_聚合函数</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/4fsjd16k/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第09章_子查询</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/5fre8wx1/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第10章_创建和管理表</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/aodt7kij/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第11章_数据处理之增删改</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/feuhpohs/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第12章_MySQL数据类型精讲</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/utbdi7eh/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第13章_约束</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/t5z4fo16/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第14章_视图</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/y0hix5xq/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第15章_存储过程与函数</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/wa8pqbfi/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第16章_变量、流程控制与游标</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/srx7ys3m/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第17章_触发器</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-994e26d4 data-v-994e26d4><div class="item" data-v-994e26d4><div class="indicator" data-v-994e26d4></div><!----><a class="vp-link link link" href="/mysql/kprca6qs/" data-v-994e26d4><!--[--><p class="text" data-v-994e26d4><span data-v-994e26d4>第18章_MySQL8其它新特性</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-27c095d7 data-v-5b39a01b><div class="vp-doc-container has-sidebar has-aside" data-v-5b39a01b data-v-0d7da0a5><!--[--><!--]--><div class="container" data-v-0d7da0a5><div class="aside" vp-outline data-v-0d7da0a5><div class="aside-curtain" data-v-0d7da0a5></div><div class="aside-container" data-v-0d7da0a5><div class="aside-content" data-v-0d7da0a5><div class="vp-doc-aside" data-v-0d7da0a5 data-v-6df97c7f><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-6df97c7f data-v-3003aeb2><div class="content" data-v-3003aeb2><div class="outline-marker" data-v-3003aeb2></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-3003aeb2><span data-v-3003aeb2>目录</span><span class="vpi-print icon" data-v-3003aeb2></span></div><ul class="root" data-v-3003aeb2 data-v-f4c16ca0><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6df97c7f></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-0d7da0a5><div class="content-container" data-v-0d7da0a5><!--[--><!--]--><main class="main" data-v-0d7da0a5><nav class="vp-breadcrumb" data-v-0d7da0a5 data-v-eeb0b690><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-eeb0b690><!--[--><li property="itemListElement" typeof="ListItem" data-v-eeb0b690><a class="vp-link link breadcrumb" href="/" property="item" typeof="WebPage" data-v-eeb0b690><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-eeb0b690></span><meta property="name" content="首页" data-v-eeb0b690><meta property="position" content="1" data-v-eeb0b690></li><li property="itemListElement" typeof="ListItem" data-v-eeb0b690><span class="vp-link breadcrumb" property="item" typeof="WebPage" data-v-eeb0b690><!--[-->MYSQL<!--]--><!----></span><span class="vpi-chevron-right" data-v-eeb0b690></span><meta property="name" content="MYSQL" data-v-eeb0b690><meta property="position" content="2" data-v-eeb0b690></li><li property="itemListElement" typeof="ListItem" data-v-eeb0b690><a class="vp-link link breadcrumb current" href="/mysql/9an63vlq/" property="item" typeof="WebPage" data-v-eeb0b690><!--[-->第08章_聚合函数<!--]--><!----></a><!----><meta property="name" content="第08章_聚合函数" data-v-eeb0b690><meta property="position" content="3" data-v-eeb0b690></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-e9ba3c81><!----> 第08章_聚合函数 <!----></h1><div class="vp-doc-meta" data-v-e9ba3c81><!--[--><!--]--><p class="reading-time" data-v-e9ba3c81><span class="vpi-books icon" data-v-e9ba3c81></span><span data-v-e9ba3c81>约 2639 字</span><span data-v-e9ba3c81>大约 9 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-e9ba3c81><span class="vpi-clock icon" data-v-e9ba3c81></span><span data-v-e9ba3c81>2025-09-02</span></p></div><!--]--><!--[--><!--]--><div class="_mysql_9an63vlq_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-0d7da0a5><!--[--><!--]--><div data-v-0d7da0a5><p>上一章讲到了 SQL 单行函数。实际上 SQL 函数还有一类，叫做聚合（或聚集、分组）函数，它是对一组数据进行汇总的函数，输入的是一组数据的集合，输出的是单个值。</p><h2 id="_1-聚合函数介绍" tabindex="-1"><a class="header-anchor" href="#_1-聚合函数介绍"><span>1. 聚合函数介绍</span></a></h2><ul><li>什么是聚合函数</li></ul><p>聚合函数作用于一组数据，并对一组数据返回一个值</p><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394412-fa2295a8-a4f9-4a19-bf63-acd4ae9d626e.png" alt=""></p><ul><li>聚合函数类型 <ul><li><strong>AVG()</strong></li><li><strong>SUM()</strong></li><li><strong>MAX()</strong></li><li><strong>MIN()</strong></li><li><strong>COUNT()</strong></li></ul></li><li>聚合函数语法 <img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394498-be4bb0b9-3c73-42c9-9426-e03710881b90.png" alt=""></li><li>聚合函数不能嵌套调用。比如不能出现类似“<code>AVG(SUM(字段名称))</code>”形式的调用</li></ul><h3 id="_1-1-avg-和-sum-函数" tabindex="-1"><a class="header-anchor" href="#_1-1-avg-和-sum-函数"><span>1.1 AVG 和 SUM 函数</span></a></h3><p>可以对 <strong>数值型数据</strong> 使用<code>AVG</code> 和 <code>SUM</code> 函数</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Avg</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary),  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">       Max</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary),  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">       Min</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary),  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">       Sum</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  job_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">LIKE</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C3E88D;">%REP%</span><span style="--shiki-light:#032F62;--shiki-dark:#89DDFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +-------------+-------------+-------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | Avg(salary) | Max(salary) | Min(salary) | Sum(salary) |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +-------------+-------------+-------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | 8272.727273 |    11500.00 |     6000.00 |   273000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +-------------+-------------+-------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 1 row in set (0.00 sec)</span></span></code></pre></div><h3 id="_1-2-min-和-max-函数" tabindex="-1"><a class="header-anchor" href="#_1-2-min-和-max-函数"><span>1.2 MIN 和 MAX 函数</span></a></h3><p>可以对 <strong>任意数据类型</strong> 的数据使用 <code>MIN</code> 和 <code>MAX</code> 函数</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Min</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(hire_date),  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">       Max</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(hire_date)  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +----------------+----------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | Min(hire_date) | Max(hire_date) |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +----------------+----------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | 1987-06-17     | 2000-04-21     |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +----------------+----------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 1 row in set (0.00 sec)</span></span></code></pre></div><h3 id="_1-3-count-函数" tabindex="-1"><a class="header-anchor" href="#_1-3-count-函数"><span>1.3 COUNT 函数</span></a></h3><ul><li><code>COUNT(*)</code>返回表中记录总数，适用于 <strong>任意数据类型</strong></li></ul><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Count</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">)  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +----------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | Count(*) |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +----------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |       45 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +----------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 1 row in set (0.00 sec)</span></span></code></pre></div><ul><li><code>COUNT(expr)</code>返回 <strong>expr不为空</strong> 的记录总数。</li></ul><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Count</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(commission_pct)  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +-----------------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | Count(commission_pct) |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +-----------------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |                     0 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +-----------------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 1 row in set (0.00 sec)</span></span></code></pre></div><ul><li>问题：用<code>count(*)</code>，<code>count(1)</code>，<code>count(列名)</code>谁好呢?</li></ul><p>其实，对于<code>MyISAM</code>引擎的表是没有区别的。这种引擎内部有一计数器在维护着行数。<br><code>Innodb</code>引擎的表用<code>count(*),</code>count(1)直接读行数，复杂度是O(n)，因为<code>innodb</code>真的要去数一遍。但好于具体的<code>count(列名)</code>。</p><ul><li>问题：能不能使用<code>count(列名)</code>替换<code>count(*)</code>?</li></ul><p>不要使用 <code>count(列名)</code>来替代 <code>count(*)</code>，<code>count(*)</code>是 SQL92 定义的标准统计行数的语法，跟数据库无关，跟 <strong>NULL</strong> 和<strong>非 NULL</strong> 无关。</p><p>说明：<code>count(*)</code><strong>会统计值为 NULL 的行，而</strong><code>count(列名)</code><strong>不会统计此列为 NULL 值的行。</strong></p><h2 id="_2-group-by" tabindex="-1"><a class="header-anchor" href="#_2-group-by"><span>2. GROUP BY</span></a></h2><h3 id="_2-1-基本使用" tabindex="-1"><a class="header-anchor" href="#_2-1-基本使用"><span>2.1 基本使用</span></a></h3><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394571-73c0811b-a527-428e-9a62-0a54c46fba60.png" alt=""></p><p><strong>可以使用</strong><code>GROUP BY</code><strong>子句将表中的数据分成若干组</strong></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> column, group_function(column)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> table</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">[WHERE condition]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">[GROUP BY group_by_expression]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">[ORDER BY column];</span></span></code></pre></div><blockquote><p>明确：<strong>WHERE一定放在FROM后面</strong></p></blockquote><p><strong>在SELECT列表中所有未包含在组函数中的列都应该包含在 GROUP BY子句中</strong>:</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id,  </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">       Avg</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------------+--------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | department_id | Avg(salary)  |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------------+--------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |          NULL |  7000.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            10 |  4400.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            20 |  9500.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            30 |  4150.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            40 |  6500.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            50 |  3475.555556 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            60 |  5760.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            70 | 10000.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            80 |  8955.882353 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            90 | 19333.333333 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |           100 |  8600.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |           110 | 10150.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------------+--------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 12 rows in set (0.00 sec)</span></span></code></pre></div><p>包含在 GROUP BY 子句中的列不必包含在SELECT 列表中</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Avg</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +--------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | Avg(salary)  |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +--------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |  7000.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |  4400.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |  9500.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |  4150.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |  6500.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |  3475.555556 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |  5760.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | 10000.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |  8955.882353 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | 19333.333333 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |  8600.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | 10150.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +--------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 12 rows in set (0.00 sec)</span></span></code></pre></div><h3 id="_2-2-使用多个列分组" tabindex="-1"><a class="header-anchor" href="#_2-2-使用多个列分组"><span>2.2 使用多个列分组</span></a></h3><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394676-434438b1-74f0-4b82-a4a2-db5c96821e12.png" alt=""></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id dept_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">       job_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">       Sum</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">          job_id;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">          </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------+------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | dept_id | job_id     | Sum(salary) |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------+------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      90 | AD_PRES    |    24000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      90 | AD_VP      |    34000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      60 | IT_PROG    |    28800.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |     100 | FI_MGR     |    12000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |     100 | FI_ACCOUNT |    39600.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      30 | PU_MAN     |    11000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      30 | PU_CLERK   |    13900.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      50 | ST_MAN     |    36400.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      50 | ST_CLERK   |    55700.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      80 | SA_MAN     |    61000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      80 | SA_REP     |   243500.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |    NULL | SA_REP     |     7000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      50 | SH_CLERK   |    64300.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      10 | AD_ASST    |     4400.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      20 | MK_MAN     |    13000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      20 | MK_REP     |     6000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      40 | HR_REP     |     6500.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |      70 | PR_REP     |    10000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |     110 | AC_MGR     |    12000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |     110 | AC_ACCOUNT |     8300.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------+------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 20 rows in set (0.00 sec)</span></span></code></pre></div><h3 id="_2-3-group-by-中使用-with-rollup" tabindex="-1"><a class="header-anchor" href="#_2-3-group-by-中使用-with-rollup"><span>2.3 GROUP BY 中使用 WITH ROLLUP</span></a></h3><p>使用<code>WITH ROLLUP</code>关键字之后，在所有查询出的分组记录之后增加一条记录，该记录计算查询出的所有记录的总和，即统计记录数量</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">       Avg</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">  department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 80</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WITH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> rollup</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------------+--------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | department_id | Avg(salary)  |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------------+--------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            90 | 19333.333333 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |           100 |  8600.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |           110 | 10150.000000 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |          NULL | 11809.090909 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------------+--------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 4 rows in set (0.00 sec)</span></span></code></pre></div><blockquote><p>注意:<br> 当使用ROLLUP时，不能同时使用ORDER BY子句进行结果排序，即ROLLUP和ORDER BY是互相排斥的</p></blockquote><h2 id="_3-having" tabindex="-1"><a class="header-anchor" href="#_3-having"><span>3. HAVING</span></a></h2><h3 id="_3-1-基本使用" tabindex="-1"><a class="header-anchor" href="#_3-1-基本使用"><span>3.1 基本使用</span></a></h3><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394753-ddeef0ac-44f2-4e52-ac34-18c2cc56b32b.png" alt=""></p><p><strong>过滤分组：</strong><code>HAVING</code><strong>子句</strong></p><ol><li>行已经被分组</li><li>使用了聚合函数</li><li>满足HAVING 子句中条件的分组将被显示</li><li>HAVING 不能单独使用，必须要跟 GROUP BY 一起使用</li></ol><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394824-324ebab8-3053-4009-be58-9678b5cd6387.png" alt=""></p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">       Max</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">   employees</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP  BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> department_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">HAVING</span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;"> Max</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(salary) </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 10000</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- | department_id | Max(salary) |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            20 |    13000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            30 |    11000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            80 |    14000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |            90 |    24000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |           100 |    12000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- |           110 |    12000.00 |</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- +---------------+-------------+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#464B5D;--shiki-dark-font-style:italic;">-- 6 rows in set (0.00 sec)</span></span></code></pre></div><ul><li><strong>非法使用聚合函数 ： 不能在 WHERE 子句中使用聚合函数。 如下</strong> <img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394889-0eed19a9-fb59-4fca-b524-f087c9a5acd6.png" alt=""></li></ul><h3 id="_3-2-where-和-having-的对比" tabindex="-1"><a class="header-anchor" href="#_3-2-where-和-having-的对比"><span>3.2 WHERE 和 HAVING 的对比</span></a></h3><p><strong>区别 1 ：WHERE 可以直接使用表中的字段作为筛选条件，但不能使用分组中的计算函数作为筛选条件; HAVING 必须要与 GROUP BY 配合使用，可以把分组计算的函数和分组字段作为筛选条件。</strong></p><p>这决定了，在需要对数据进行分组统计的时候，HAVING 可以完成 WHERE 不能完成的任务。这是因为在查询语法结构中，WHERE 在 GROUP BY 之前，所以无法对分组结果进行筛选。HAVING 在 GROUP BY 之后，可以使用分组字段和分组中的计算函数，对分组的结果集进行筛选，这个功能是 WHERE 无法完成的。另外，WHERE排除的记录不再包括在分组中。</p><p><strong>区别 2 ：如果需要通过连接从关联表中获取需要的数据，WHERE 是先筛选后连接，而 HAVING 是先连接后筛选。</strong> 这一点，就决定了在关联查询中，WHERE 比 HAVING 更高效。因为 WHERE 可以先筛选，用一个筛选后的较小数据集和关联表进行连接，这样占用的资源比较少，执行效率也比较高。HAVING 则需要先把结果集准备好，也就是用未被筛选的数据集进行关联，然后对这个大的数据集进行筛选，这样占用的资源就比较多，执行效率也较低。</p><p><strong>小结</strong>：</p><table><thead><tr><th></th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>WHERE</td><td>先筛选数据再关联，执行效率高</td><td>不能使用分组中的计算函数进行筛选</td></tr><tr><td>HAVING</td><td>可以使用分组中的计算函数</td><td>在最后的结果集中进行筛选，执行效率较低</td></tr></tbody></table><p><strong>开发中的选择</strong>：<br> WHERE 和 HAVING 也不是互相排斥的，我们可以在一个查询里面同时使用 WHERE 和 HAVING。包含分组统计函数的条件用 HAVING，普通条件用 WHERE。这样，我们就既利用了 WHERE 条件的高效快速，又发挥了 HAVING 可以使用包含分组统计函数的查询条件的优点。当数据量特别大的时候，运行效率会有很大的差别</p><h2 id="_4-select-的执行过程" tabindex="-1"><a class="header-anchor" href="#_4-select-的执行过程"><span>4. SELECT 的执行过程</span></a></h2><h3 id="_4-1-查询的结构" tabindex="-1"><a class="header-anchor" href="#_4-1-查询的结构"><span>4.1 查询的结构</span></a></h3><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#方式 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ：</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ..., ..., ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ..., ..., ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 多表的连接条件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AND</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 不包含组函数的过滤条件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ..., ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">HAVING</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 包含组函数的过滤条件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> DESC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">LIMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ..., ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#方式 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ：</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ..., ..., ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 多表的连接条件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 不包含组函数的过滤条件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">AND</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> OR</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 不包含组函数的过滤条件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ..., ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">HAVING</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 包含组函数的过滤条件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ... </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ASC</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> /</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> DESC</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">LIMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ..., ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#其中：</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#（ </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ）</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">：从哪些表中筛选</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#（ </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ）</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">：关联多表查询时，去除笛卡尔积</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#（ </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ）</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">：从表中筛选的条件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#（ </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ）</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">group by</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">：分组依据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#（ </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ）</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">having</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">：在统计结果中再次筛选</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#（ </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ）</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">order by</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">：排序</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">#（ </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ）</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">limit</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">：分页</span></span></code></pre></div><h3 id="_4-2-select-执行顺序" tabindex="-1"><a class="header-anchor" href="#_4-2-select-执行顺序"><span>4.2 SELECT 执行顺序</span></a></h3><p>你需要记住 SELECT 查询时的两个顺序:</p><ul><li><strong>关键字的顺序是不能颠倒的</strong></li></ul><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">HAVING</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> ...</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">LIMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">...</span></span></code></pre></div><ul><li><strong>SELECT 语句的执行顺序</strong>（在 MySQL 和 Oracle 中，SELECT 执行顺序基本相同）：</li></ul><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> -&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> -&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> GROUP BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> -&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> HAVING</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> -&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> 的字段 </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">-&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> DISTINCT</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> -&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> -&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;"> LIMIT</span></span></code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2025/png/2447732/1756779394957-e9446b44-547e-4fde-aa9f-6112ddc257be.png" alt=""></p><p>比如你写了一个 SQL 语句，那么它的关键字顺序和执行顺序是下面这样的:</p><div class="language-sql" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#24292e;--shiki-dark:#babed8;--shiki-light-bg:#fff;--shiki-dark-bg:#0F111A;"><pre class="shiki shiki-themes github-light material-theme-ocean vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">SELECT DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> player_id, player_name, </span><span style="--shiki-light:#005CC5;--shiki-dark:#82AAFF;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> num    # 顺序 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> player </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> team </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> player</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">team_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> team</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">team_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">     # 顺序 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> height </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">                                        # 顺序 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">GROUP BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;"> player</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BABED8;">team_id</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">                                    # 顺序 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">HAVING</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> num </span><span style="--shiki-light:#D73A49;--shiki-dark:#89DDFF;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">                                             # 顺序 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">4</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">ORDER BY</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;"> num </span><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">                                          # 顺序 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">6</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F78C6C;">LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#BABED8;">                                                    # 顺序 </span><span style="--shiki-light:#005CC5;--shiki-dark:#F78C6C;">7</span></span></code></pre></div><p>在 SELECT 语句执行这些步骤的时候，每个步骤都会产生一个<strong>虚拟表</strong>，然后将这个虚拟表传入下一个步骤中作为输入。需要注意的是，这些步骤隐含在 SQL 的执行过程中，对于我们来说是不可见的。</p><h3 id="_4-3-sql-的执行原理" tabindex="-1"><a class="header-anchor" href="#_4-3-sql-的执行原理"><span>4.3 SQL 的执行原理</span></a></h3><p>SELECT 是先执行 <strong>FROM</strong> 这一步的。在这个阶段，如果是多张表联查，还会经历下面的几个步骤：</p><ol><li>首先先通过 <code>CROSS JOIN</code> 求笛卡尔积，相当于得到虚拟表 <code>vt(virtual table)1-1</code>；</li><li>通过 <code>ON</code> 进行筛选，在虚拟表 <code>vt1-1</code> 的基础上进行筛选，得到虚拟表 <code>vt1-2</code>；</li><li>添加外部行。如果我们使用的是左连接、右链接或者全连接，就会涉及到外部行，也就是在虚拟表 <code>vt1-2</code> 的基础上增加外部行，得到虚拟表 <code>vt1-3</code>。</li></ol><p>当然如果我们操作的是两张以上的表，还会重复上面的步骤，直到所有表都被处理完为止。这个过程得到是我们的原始数据。</p><p>当我们拿到了查询数据表的原始数据，也就是最终的虚拟表 <code>vt1</code>，就可以在此基础上再进行 <strong>WHERE</strong> 阶段。在这个阶段中，会根据 <code>vt1</code> 表的结果进行筛选过滤，得到虚拟表 <code>vt2</code>。</p><p>然后进入第三步和第四步，也就是 <strong>GROUP</strong> 和 <strong>HAVING</strong> 阶段。在这个阶段中，实际上是在虚拟表 <code>vt2</code> 的基础上进行分组和分组过滤，得到中间的虚拟表 <code>vt3</code> 和 <code>vt4</code>。</p><p>当我们完成了条件筛选部分之后，就可以筛选表中提取的字段，也就是进入到 <strong>SELECT</strong> 和 <strong>DISTINCT</strong> 阶段。</p><p>首先在 SELECT 阶段会提取想要的字段，然后在 DISTINCT 阶段过滤掉重复的行，分别得到中间的虚拟表<code>vt5-1</code> 和 <code>vt5-2</code> 。</p><p>当我们提取了想要的字段数据之后，就可以按照指定的字段进行排序，也就是 <strong>ORDER BY</strong> 阶段，得到虚拟表 <code>vt6</code>。</p><p>最后在 <code>vt6</code> 的基础上，取出指定行的记录，也就是 <strong>LIMIT</strong> 阶段，得到最终的结果，对应的是虚拟表 <code>vt7</code>。</p><p>当然我们在写 SELECT 语句的时候，不一定存在所有的关键字，相应的阶段就会省略。</p><p>同时因为 SQL 是一门类似英语的结构化查询语言，所以我们在写 SELECT 语句的时候，还要注意相应的关键字顺序， <strong>所谓底层运行的原理，就是我们刚才讲到的执行顺序。</strong></p></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-0d7da0a5 data-v-83bdd30b><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-83bdd30b><span class="contributors-label" data-v-83bdd30b>贡献者: </span><span class="contributors-info" data-v-83bdd30b><!--[--><!--[--><span class="contributor" data-v-83bdd30b>weew12</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-83bdd30b><div class="pager" data-v-83bdd30b><a class="vp-link link pager-link prev" href="/mysql/c0jgzz2u/" data-v-83bdd30b><!--[--><span class="desc" data-v-83bdd30b>上一页</span><span class="title" data-v-83bdd30b>第07章_单行函数</span><!--]--><!----></a></div><div class="pager" data-v-83bdd30b><a class="vp-link link pager-link next" href="/mysql/4fsjd16k/" data-v-83bdd30b><!--[--><span class="desc" data-v-83bdd30b>下一页</span><span class="title" data-v-83bdd30b>第09章_子查询</span><!--]--><!----></a></div></nav></footer><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;" data-v-0d7da0a5><div style="display: flex;align-items: center;justify-content: center;height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);--icon-size: 48px;display: inline-block;width: var(--icon-size);height: var(--icon-size);background-color: currentcolor;-webkit-mask-image: var(--loading-icon);mask-image: var(--loading-icon)"></span></div></div><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-27c095d7 data-v-7a5f51ab><span class="percent" data-allow-mismatch data-v-7a5f51ab>0%</span><span class="show icon vpi-back-to-top" data-v-7a5f51ab></span><svg aria-hidden="true" data-v-7a5f51ab><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-7a5f51ab></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-27c095d7 data-v-fe15003d><!--[--><div class="container" data-v-fe15003d><!----><p class="copyright" data-v-fe15003d>Copyright © 2026 weew12</p></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-BO2U5m27.js" defer></script></body></html>